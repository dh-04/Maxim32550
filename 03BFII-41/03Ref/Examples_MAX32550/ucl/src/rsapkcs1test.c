/*
 * @file rsapkcs1test.c
 *
 ******************************************************************************
 * Copyright (C) 2016-2018 Maxim Integrated Products, Inc., All rights Reserved.
 *
 * This software is protected by copyright laws of the United States and
 * of foreign countries. This material may also be protected by patent laws
 * and technology transfer regulations of the United States and of foreign
 * countries. This software is furnished under a license agreement and/or a
 * nondisclosure agreement and may only be used or reproduced in accordance
 * with the terms of those agreements. Dissemination of this information to
 * any party or parties not specified in the license agreement and/or
 * nondisclosure agreement is expressly prohibited.
 *
 * The above copyright notice and this permission notice shall be included
 * in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
 * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
 * IN NO EVENT SHALL MAXIM INTEGRATED BE LIABLE FOR ANY CLAIM, DAMAGES
 * OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
 * ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 *
 * Except as contained in this notice, the name of Maxim Integrated
 * Products, Inc. shall not be used except as stated in the Maxim Integrated
 * Products, Inc. Branding Policy.
 *
 * The mere transfer of this software does not imply any licenses
 * of trade secrets, proprietary technology, copyrights, patents,
 * trademarks, maskwork rights, or any other form of intellectual
 * property whatsoever. Maxim Integrated Products, Inc. retains all
 * ownership rights.
 ******************************************************************************
 */

/** @file rsapkcs1test.c */

#ifdef JIBE_LINUX
#include "config.h"
#endif
#include <ucl_testing_config.h>

#ifdef SYSTEM_JIBE
#include <printf_lite.h>
#endif
#ifdef SYSTEM_LIGHTHOUSE
#include <printf_lite.h>
#endif

#include <rsapkcs1test.h>

#include <string.h>
#include <ucl/ucl_retdefs.h>
#include <ucl/ucl_types.h>
#include <ucl/ucl_config.h>
#include <ucl/ucl_defs.h>
#include <ucl/ucl_sys.h>
#include <ucl/ucl_sha1.h>
#include <ucl/ucl_md5.h>
#include <ucl/ucl_sha224.h>
#include <ucl/ucl_sha256.h>
#include <ucl/ucl_sha384.h>
#include <ucl/ucl_sha512.h>
#include <ucl/ucl_rsa.h>
#include <ucl/ucl_rsa2vs.h>
#include <ucl/ucl_data_conv.h>
#include <ucl/ucl_pkcs1_ssa_pkcs1v15.h>
#include <ucl/ucl_pkcs1_ssa_pkcs1v15_sha256.h>
#include <ucl/ucl_pkcs1_ssa_pkcs1v15_sha1.h>
#include <ucl/ucl_pkcs1_ssa_pss.h>
#include <ucl/ucl_pkcs1_ssa_pss_sha224.h>
#include <ucl/ucl_pkcs1_ssa_pss_sha256.h>
#include <ucl/ucl_pkcs1_ssa_pss_sha384.h>
#include <ucl/ucl_pkcs1_ssa_pss_sha512.h>
#include <ucl/ucl_pkcs1_ssa_pss_sha1.h>
#include <ucl/ucl_pkcs1_ssa_pss_md5.h>
#include <ucl/ucl_pkcs1_es_pkcs1v15.h>
#include <ucl/ucl_pkcs1_es_oaep_sha1.h>
#include <ucl/ucl_pkcs1_es_oaep_sha224.h>
#include <ucl/ucl_pkcs1_es_oaep_sha256.h>
#include <ucl/ucl_pkcs1_es_oaep_sha384.h>
#include <ucl/ucl_pkcs1_es_oaep_sha512.h>
#include <ucl/ucl_pkcs1_es_oaep_md5.h>
#include <ucl/ucl_stack.h>
#include <ucl/ucl_rng.h>
#include <ucl/bignum_ecdsa_generic_api.h>
#define UCL_RSA_KEY_MAXPRE (UCL_RSA_KEY_MAXSIZE/4)

u8 n_pkcs1[] = {0xd4,0x94,0xa3,0xcd,0x3f,0x7b,0x36,0x43,0x80,0xf1,0x3e,0xe8,0x47,0x56,0xe1,0x76,0x4d,0xa3,0x8e,0x24,0x27,0xfc,0x62,0x90,0xe3,0x3a,0x94,0xf5,0xb1,0xe3,0x4a,0x25,0xd8,0xb5,0x9a,0xd5,0x0c,0x96,0x03,0xd7,0x29,0xca,0x16,0x99,0x38,0x49,0x5e,0x35,0x03,0x59,0x11,0xa0,0x95,0xcf,0x7c,0xe2,0x08,0xed,0xc0,0x51,0x0e,0x66,0x91,0x10,0x20,0x75,0x76,0xce,0xe2,0x82,0x90,0x43,0xbc,0xbb,0xcb,0x27,0x0e,0xb4,0x56,0x34,0x23,0xae,0x6d,0x63,0xf0,0x13,0x5d,0xc5,0xe3,0xbd,0xaa,0xdb,0x9f,0x57,0x42,0xf9,0x40,0x45,0xa0,0x43,0x58,0x96,0x7b,0xb4,0x31,0xa2,0xb2,0x0e,0xf0,0xee,0x36,0xd5,0x82,0xef,0x49,0x4b,0xac,0x8f,0xc7,0x60,0x02,0x36,0x13,0xa0,0xff,0xf1,0x8c,0xe7};
  //SHAAlg = SHA1

u8 e_pkcs1[] = {0x11};
u8 d_pkcs1[] = {0x06,0x40,0x9b,0x67,0xeb,0x47,0x63,0x7a,0x74,0xbb,0xcd,0x24,0xf3,0x0a,0x15,0xb0,0xa7,0xee,0x38,0xe2,0xf2,0x1e,0x02,0xe6,0x24,0xcd,0x04,0x61,0x94,0x4a,0x73,0x1f,0x3b,0x14,0x66,0x6f,0xad,0x8b,0xf1,0x0d,0xdb,0x95,0x00,0xaa,0x27,0x4d,0x73,0xb6,0x43,0xdc,0xf8,0xfd,0x31,0x95,0x29,0x51,0xf1,0x34,0x2b,0x4d,0xad,0x99,0x9a,0xda,0xc6,0x0d,0xc1,0x6b,0xb2,0x11,0x7a,0xe2,0x89,0xbf,0x07,0x0c,0x5e,0xd2,0xaf,0xdb,0xea,0xd0,0xee,0x40,0xeb,0xc0,0x8b,0x53,0xc9,0x85,0x01,0xe3,0x53,0xdb,0x5d,0x15,0x89,0x84,0xa9,0x27,0x5f,0xe4,0xeb,0x4b,0x2f,0x6a,0x55,0x0b,0x7c,0x45,0x0a,0xdb,0x6a,0xb0,0x64,0x46,0x4c,0xa1,0x9e,0x42,0x28,0x29,0x08,0x83,0x53,0x01,0xe3,0xf1};
u8 msg_pkcs1[] = {0xca,0x2b,0xfa,0xad,0x62,0x49,0x2e,0x9f,0x1c,0xaa,0xa0,0xcc,0x52,0x0d,0xa0,0x8c,0x0d,0x2d,0x91,0x0c,0xd4,0x42,0x55,0xf4,0xc2,0xca,0x06,0x46,0xdc,0x89,0xe7,0x89,0xa1,0xcf,0x9a,0x28,0xe2,0xf9,0x93,0x15,0xd3,0x3a,0xcc,0xb1,0x63,0x9c,0xba,0xf0,0xc9,0x41,0x81,0xb8,0x5f,0xef,0x64,0x8b,0xb4,0xcc,0x7f,0x66,0xdc,0x65,0xb8,0xe9,0x0b,0xf5,0xf3,0xb7,0x63,0xe5,0x85,0x20,0x09,0x8f,0xeb,0xfe,0x7e,0x47,0xbd,0xdc,0x2d,0x9c,0xdd,0x5e,0x40,0xdb,0xf4,0xdd,0xb8,0xd5,0x1f,0x51,0xbd,0xe2,0xe5,0x74,0x32,0x26,0x6d,0x24,0x8d,0x13,0xed,0x09,0xe6,0x2f,0x66,0x79,0x4d,0x18,0x8f,0x98,0x61,0xc5,0x0e,0xc4,0x1f,0x0e,0xee,0x30,0xf7,0x6f,0x4e,0xce,0x25,0x09,0x56,0x73};
u8 e3[]={0x03};
u8 n3[]={0xe2,0x8a,0x13,0x54,0x85,0x25,0xe5,0xf3,0x6d,0xcc,0xb2,0x4e,0xcb,0x7c,0xc3,0x32,0xcc,0x68,0x9d,0xfd,0x64,0x01,0x26,0x04,0xc9,0xc7,0x81,0x6d,0x72,0xa1,0x6c,0x3f,0x5f,0xcd,0xc0,0xe8,0x6e,0x7c,0x03,0x28,0x0b,0x1c,0x69,0xb5,0x86,0xce,0x0c,0xd8,0xae,0xc7,0x22,0xcc,0x73,0xa5,0xd3,0xb7,0x30,0x31,0x0b,0xf7,0xdf,0xeb,0xdc,0x77,0xce,0x5d,0x94,0xbb,0xc3,0x69,0xdc,0x18,0xa2,0xf7,0xb0,0x7b,0xd5,0x05,0xab,0x0f,0x82,0x22,0x4a,0xef,0x09,0xfd,0xc1,0xe5,0x06,0x32,0x34,0x25,0x5e,0x0b,0x3c,0x40,0xa5,0x2e,0x9e,0x8a,0xe6,0x08,0x98,0xeb,0x88,0xa7,0x66,0xbd,0xd7,0x88,0xfe,0x94,0x93,0xd8,0xfd,0x86,0xbc,0xdd,0x28,0x84,0xd5,0xc0,0x62,0x16,0xc6,0x54,0x69,0xe5};
u8 s3[]={0x5a,0xbc,0x01,0xf5,0xde,0x25,0xb7,0x08,0x67,0xff,0x0c,0x24,0xe2,0x22,0xc6,0x1f,0x53,0xc8,0x8d,0xaf,0x42,0x58,0x6f,0xdd,0xcd,0x56,0xf3,0xc4,0x58,0x8f,0x07,0x4b,0xe3,0xc3,0x28,0x05,0x6c,0x06,0x33,0x88,0x68,0x8b,0x63,0x85,0xa8,0x16,0x79,0x57,0xc6,0xe5,0x35,0x5a,0x51,0x0e,0x00,0x5b,0x8a,0x85,0x1d,0x69,0xc9,0x6b,0x36,0xec,0x60,0x36,0x64,0x40,0x78,0x21,0x0e,0x5d,0x7d,0x32,0x6f,0x96,0x36,0x5e,0xe0,0x64,0x88,0x82,0x92,0x14,0x92,0xbc,0x7b,0x75,0x3e,0xb9,0xc2,0x6c,0xdb,0xab,0x37,0x55,0x5f,0x21,0x0d,0xf2,0xca,0x6f,0xec,0x1b,0x25,0xb4,0x63,0xd3,0x8b,0x81,0xc0,0xdc,0xea,0x20,0x20,0x22,0xb0,0x4a,0xf5,0xda,0x58,0xaa,0x03,0xd7,0x7b,0xe9,0x49,0xb7};
u8 msg3[]={0x20,0x6e,0xf4,0xbf,0x39,0x6c,0x60,0x87,0xf8,0x22,0x9e,0xf1,0x96,0xfd,0x35,0xf3,0x7c,0xcb,0x8d,0xe5,0xef,0xcd,0xb2,0x38,0xf2,0x0d,0x55,0x66,0x68,0xf1,0x14,0x25,0x7a,0x11,0xfb,0xe0,0x38,0x46,0x4a,0x67,0x83,0x03,0x78,0xe6,0x2a,0xe9,0x79,0x14,0x53,0x95,0x3d,0xac,0x1d,0xbd,0x79,0x21,0x83,0x7b,0xa9,0x8e,0x84,0xe8,0x56,0xeb,0x80,0xed,0x94,0x87,0xe6,0x56,0xd0,0xb2,0x0c,0x28,0xc8,0xba,0x5e,0x35,0xdb,0x1a,0xbb,0xed,0x83,0xed,0x1c,0x77,0x20,0xa9,0x77,0x01,0xf7,0x09,0xe3,0x54,0x7a,0x4b,0xfc,0xab,0xca,0x9c,0x89,0xc5,0x7a,0xd1,0x5c,0x39,0x96,0x57,0x7a,0x0a,0xe3,0x6d,0x7c,0x7b,0x69,0x90,0x35,0x24,0x2f,0x37,0x95,0x46,0x46,0xc1,0xcd,0x5c,0x08,0xac};
u8 e4[] = {0x01,0x00,0x01};
u8 msg4[] = {0x64,0x75,0x86,0xba,0x58,0x7b,0x09,0xaa,0x55,0x5d,0x1b,0x8d,0xa4,0xcd,0xf5,0xc6,0xe7,0x77,0xe0,0x88,0x59,0x37,0x9c,0xa4,0x57,0x89,0x01,0x9f,0x20,0x41,0xe7,0x08,0xd9,0x7c,0x44,0x08,0xd4,0xd6,0x94,0x3b,0x11,0xdd,0x7e,0xbe,0x05,0xc6,0xb4,0x8a,0x9b,0x5f,0x1b,0x00,0x79,0x45,0x2c,0xc4,0x84,0x57,0x9a,0xcf,0xa6,0x6a,0x34,0xc0,0xcf,0x3f,0x0e,0x73,0x39,0xb2,0xdb,0xd5,0xf1,0x33,0x9e,0xf7,0x93,0x7a,0x82,0x61,0x54,0x77,0x05,0xa8,0x46,0x88,0x5c,0x43,0xd8,0xef,0x13,0x9a,0x9c,0x83,0xf5,0x60,0x4e,0xa5,0x2b,0x23,0x11,0x76,0xa8,0x21,0xfb,0x48,0xc4,0x5e,0xd4,0x52,0x26,0xf3,0x1b,0xa7,0xe8,0xa9,0x4a,0x69,0xf6,0xc6,0x5c,0x39,0xb7,0x27,0x8b,0xf3,0xf0,0x8f};
u8 s4[] = {0xe2,0x7a,0x90,0xb6,0x44,0xc3,0xa1,0x1f,0x23,0x41,0x32,0xd6,0x72,0x7a,0xda,0x39,0x77,0x74,0xcd,0x7f,0xdf,0x5e,0xb0,0x16,0x0a,0x66,0x5f,0xfc,0xce,0xda,0xbb,0x8a,0xe9,0xe3,0x57,0x96,0x69,0x39,0xa7,0x1c,0x97,0x3e,0x75,0xe5,0xff,0x77,0x1f,0xb0,0x1a,0x64,0x83,0xfc,0xaf,0x82,0xf1,0x6d,0xee,0x65,0xe6,0x82,0x61,0x21,0xe2,0xae,0x9c,0x69,0xd2,0xc9,0x23,0x87,0xb3,0x3a,0x64,0x1f,0x39,0x76,0x76,0x77,0x6c,0xde,0x50,0x1e,0x73,0x14,0xa9,0xa4,0xe7,0x6c,0x0f,0x45,0x38,0xed,0xee,0xa1,0x63,0xe8,0xde,0x7b,0xd2,0x1c,0x93,0xc2,0x98,0xdf,0x74,0x8c,0x6f,0x5c,0x26,0xb7,0xd0,0x3b,0xfa,0x36,0x71,0xf2,0xa7,0x48,0x8f,0xe3,0x11,0x30,0x9e,0x82,0x18,0xa7,0x11,0x71};

u8 e5[] = {0x11};
u8 msg5[] = {0xea,0x72,0x80,0x17,0x02,0x5d,0x65,0xb6,0x75,0x54,0xcd,0xd4,0x5a,0x24,0x25,0xb5,0x39,0x43,0xd9,0xaa,0x6f,0xa8,0xd1,0x84,0xd3,0xe0,0x3c,0x4e,0x99,0x5f,0x8c,0x3c,0x77,0x14,0xc1,0xde,0x07,0x40,0xeb,0x99,0x6d,0x87,0xea,0x58,0x39,0x48,0x79,0x7f,0x8f,0x2a,0x6b,0x21,0x85,0xf7,0x33,0x72,0xcc,0xae,0xaa,0x7f,0x93,0xd3,0x0d,0x1c,0xa8,0x0a,0x45,0x1e,0xe0,0xe4,0x6c,0xcb,0xba,0xf9,0x8c,0x8f,0x3f,0x37,0xaa,0xf1,0x2c,0x79,0x03,0xc4,0x53,0x5b,0x95,0xa2,0x3f,0x4d,0xe1,0x96,0x17,0xe7,0xf0,0x19,0xc4,0x7d,0x94,0x40,0x56,0xf2,0xf0,0x33,0xa4,0xd1,0x3a,0xe1,0x33,0x99,0xc0,0xf2,0x5a,0x59,0x29,0xfd,0xa3,0x7d,0xfe,0xfc,0x73,0xe8,0x69,0xfd,0xee,0x43,0x3c,0x1a};
u8 s5[] = {0x60,0x13,0xa7,0x58,0xb0,0x98,0x98,0x19,0x78,0x59,0xc5,0x3d,0xe5,0x9f,0xb3,0x92,0xd9,0xef,0xe7,0x40,0x82,0x63,0x23,0xa0,0xaa,0xf8,0xf1,0x89,0xb9,0x2c,0x47,0x1b,0x04,0x87,0xde,0x54,0xac,0xe6,0x24,0xb6,0xaa,0x46,0x30,0xf9,0xfd,0xe3,0xfc,0xd8,0xcd,0xff,0x4f,0x2b,0x5c,0x37,0xc2,0x0d,0x6c,0x6b,0x98,0x91,0x4d,0xce,0x18,0x5e,0xd9,0xae,0x83,0xfa,0xd9,0xfe,0x3e,0xb4,0xf7,0xd8,0x7b,0xe3,0xd4,0x1b,0x9f,0xe6,0x73,0x04,0x8b,0x2d,0xb8,0xd9,0x54,0x5a,0x67,0x89,0x16,0xed,0x2f,0x0b,0xd1,0x2e,0x6f,0xcd,0xd2,0xc1,0x6f,0x3f,0x21,0x29,0xab,0x74,0xb8,0x80,0xb5,0x9b,0xba,0xe1,0xd1,0xe7,0xd4,0x1b,0x35,0xd1,0x66,0xa7,0x6d,0xcf,0x45,0xe6,0xf7,0x88,0x70,0x36};

//SHAAlg = SHA256
u8 e6[] = {0x03};
u8 msg6[] = {0xcd,0x81,0x0e,0x97,0xdc,0x21,0x09,0x5e,0xa7,0xa0,0x23,0x80,0x27,0xa7,0xba,0xfd,0x34,0x3e,0x01,0x44,0x47,0x85,0xea,0x91,0x84,0xa4,0x4a,0x79,0xf8,0x04,0x38,0xc4,0x1f,0xc0,0xb5,0x7a,0xa9,0x56,0x93,0x40,0x7d,0xa3,0x8f,0xe5,0xff,0x0e,0xc1,0x39,0x8e,0x03,0x36,0x1e,0x51,0xa3,0xdb,0xe1,0x34,0xb9,0x9c,0xca,0x2d,0xf0,0xce,0xf1,0xc4,0x44,0xca,0x54,0xd2,0xb7,0xdb,0x27,0x89,0x45,0x5b,0x6b,0xb4,0x19,0x18,0xc2,0x40,0x01,0xfd,0x82,0xfc,0x20,0xee,0x08,0x9d,0xe3,0xf3,0x4f,0x05,0x36,0x99,0xc1,0xc5,0xf7,0x95,0x4c,0xe0,0xaa,0xab,0xb9,0xd2,0x6f,0xce,0x39,0xd0,0x32,0x89,0x41,0x52,0x22,0x9d,0x98,0xcf,0x64,0xec,0xaf,0xc7,0x08,0x95,0x30,0x07,0x3c,0x61,0xd9};
u8 s6[] = {0x7b,0x5f,0xba,0x70,0xec,0x5b,0x52,0x16,0x38,0xf1,0x82,0xbc,0xab,0x39,0xce,0xc3,0x0b,0x76,0xe7,0xbc,0x01,0x7b,0xdb,0xd1,0x05,0x96,0x58,0xa9,0xa1,0xdb,0x09,0x69,0xab,0x48,0x2d,0xce,0x32,0xf3,0xe9,0x86,0x59,0x52,0xf0,0xa0,0xde,0x09,0x78,0x27,0x2c,0x95,0x1e,0x3c,0x01,0x53,0x28,0xea,0x37,0x58,0xf4,0x70,0x29,0xa3,0x79,0xab,0x42,0x00,0x55,0x0f,0xba,0x58,0xf1,0x1d,0x51,0x26,0x48,0x78,0x40,0x6f,0xc7,0x17,0xd5,0xf7,0xb7,0x2b,0x35,0x82,0x94,0x6f,0x16,0xa7,0xe5,0x31,0x4a,0x22,0x08,0x81,0xfc,0x82,0x0f,0x7d,0x29,0x94,0x97,0x10,0x27,0x34,0x21,0x53,0x3d,0x8a,0xc0,0xa4,0x49,0xdc,0x6d,0x0f,0xd1,0xa2,0x1c,0x22,0x44,0x4e,0xdd,0x1c,0x0d,0x5b,0x44,0xd3};

//SHAAlg = SHA256
u8 e7[] = {0x01,0x00,0x01};
u8 msg7[] = {0xc8,0x1f,0x04,0xc7,0x99,0x82,0x97,0x1f,0xa1,0x76,0xd6,0x4e,0x8f,0x7f,0x88,0x12,0xf8,0x6a,0x94,0xc4,0x9e,0x84,0x67,0x2f,0xf1,0x09,0x96,0xa2,0xd6,0xdf,0xc4,0x44,0xa8,0x84,0xc7,0xa8,0x7c,0x46,0x06,0xa1,0xaa,0xb2,0x25,0x58,0x89,0x4e,0xe5,0x9b,0x79,0x8b,0x45,0x78,0x27,0xf5,0xee,0x0b,0x0c,0xad,0xcd,0x94,0x37,0x19,0x02,0xcc,0x4d,0xda,0xf9,0x7a,0xce,0xfe,0xd6,0x41,0x99,0x77,0x17,0xbc,0xb3,0xcc,0x74,0xcd,0x44,0x0f,0x0a,0x31,0xe2,0x0f,0xb9,0x58,0x12,0xce,0xcb,0x74,0x0c,0x36,0xd6,0xd1,0xbf,0x07,0xe3,0x64,0x15,0x14,0xcf,0xa6,0x78,0xaf,0xf2,0xa3,0x95,0x62,0xff,0x4d,0x60,0xe0,0x2b,0x17,0x58,0x3a,0x92,0xbf,0x0c,0x56,0xd6,0x6b,0xde,0x9e,0x09,0xf8};
u8 s7[] = {0x52,0x11,0x1f,0x47,0x98,0xda,0x3c,0x11,0xb3,0xc7,0x43,0x94,0x35,0x83,0x48,0xab,0x0f,0xc7,0x97,0xbd,0xe9,0x90,0x80,0xf2,0x38,0xd3,0x3a,0x69,0xb0,0x4b,0x08,0xac,0x2b,0xd7,0x67,0xb3,0x38,0x72,0x47,0x39,0x43,0xe2,0x3a,0xf2,0x7c,0xa3,0x2f,0xd5,0x68,0xa4,0x3a,0x8c,0x7d,0x6c,0xc5,0x5b,0x4f,0xbb,0x38,0x02,0x12,0xfd,0xfc,0xb6,0x04,0x87,0xe2,0x06,0x94,0xd4,0x28,0x7e,0x23,0x3e,0xfd,0xf7,0xb0,0x47,0x37,0xc0,0x03,0x7a,0x59,0x2d,0x03,0x07,0x78,0x01,0x82,0x8b,0x05,0x19,0x98,0xc4,0x2b,0x9f,0x9e,0x24,0x20,0x06,0x33,0x31,0xd5,0xb2,0x34,0x99,0x18,0xa6,0x4d,0x8b,0x65,0xb2,0x1a,0x20,0x11,0xee,0x73,0x18,0xfc,0xef,0x48,0xac,0xed,0x95,0xb8,0xdd,0xf5,0x01};

//SHAAlg = SHA1
// the result shall be false/FAIL/NOK !!
u8 e9[] = {0x03};
u8 msg9[] = {0xd6,0x24,0x8c,0x3e,0x96,0xb1,0xa7,0xe5,0xfe,0xa9,0x78,0x87,0x0f,0xcc,0x4c,0x97,0x86,0xb4,0xe5,0x15,0x6e,0x16,0xb7,0xfa,0xef,0x45,0x57,0xd6,0x67,0xf7,0x30,0xb8,0xbc,0x4c,0x78,0x4e,0xf0,0x0c,0x62,0x4d,0xf5,0x30,0x95,0x13,0xc3,0xa5,0xde,0x8c,0xa9,0x4c,0x21,0x52,0xe0,0x45,0x96,0x18,0x66,0x6d,0x31,0x48,0x09,0x25,0x62,0xeb,0xc2,0x56,0xff,0xca,0x45,0xb2,0x7f,0xd2,0xd6,0x3c,0x68,0xbd,0x5e,0x0a,0x0a,0xef,0xbe,0x49,0x6e,0x9e,0x63,0x83,0x8a,0x36,0x1b,0x1d,0xb6,0xfc,0x27,0x24,0x64,0xf1,0x91,0x49,0x0b,0xf9,0xc0,0x29,0x64,0x3c,0x49,0xd2,0xd9,0xcd,0x08,0x83,0x3b,0x8a,0x70,0xb4,0xb3,0x43,0x1f,0x56,0xfb,0x1e,0xb5,0x5c,0xcd,0x39,0xe7,0x7a,0x9c,0x92};
u8 s9[] = {0x32,0x03,0xb7,0x64,0x7f,0xb7,0xe3,0x45,0xaa,0x45,0x76,0x81,0xe5,0x13,0x17,0x77,0xf1,0xad,0xc3,0x71,0xf2,0xfb,0xa8,0x53,0x49,0x28,0xc4,0xe5,0x2e,0xf6,0x20,0x6a,0x85,0x64,0x25,0xd6,0x26,0x93,0x52,0xec,0xbf,0x64,0xdb,0x2f,0x6a,0xd8,0x23,0x97,0x76,0x8c,0xaf,0xdd,0x8c,0xd2,0x72,0xe5,0x12,0xd6,0x17,0xad,0x67,0x99,0x22,0x26,0xda,0x6b,0xc2,0x91,0xc3,0x14,0x04,0xc1,0x7f,0xd4,0xb7,0xe2,0xbe,0xb2,0x0e,0xff,0x28,0x4a,0x44,0xf4,0xd7,0xaf,0x47,0xfd,0x66,0x29,0xe2,0xc9,0x58,0x09,0xfa,0x7f,0x22,0x41,0xa0,0x4f,0x70,0xac,0x70,0xd3,0x27,0x1b,0xb1,0x32,0x58,0xaf,0x1e,0xd5,0xc5,0x98,0x8c,0x95,0xdf,0x7f,0xa2,0x66,0x03,0x51,0x57,0x91,0x07,0x5f,0xec,0xcd};

//SHAAlg = SHA1
// the result shall be false/FAIL/NOK !!
u8 e10[] = {0x03};
u8 msg10[] = {0x34,0xd7,0x29,0xb4,0x04,0xf0,0x85,0xe7,0xcf,0x9a,0xa0,0x8b,0x44,0x5d,0x31,0x8b,0x6b,0xb0,0x22,0x36,0x2b,0x6c,0x3a,0x4e,0x0f,0x81,0xf8,0x5b,0x4a,0xe8,0xc2,0x45,0xf8,0xd9,0x3f,0x22,0xa6,0x3d,0x01,0x4d,0x15,0x66,0x67,0xb8,0x3b,0xfe,0xc1,0x83,0x8b,0x3d,0xb6,0xcd,0x76,0x5f,0xe3,0xca,0x32,0x56,0xc5,0x15,0xba,0xbc,0xd9,0x48,0x16,0x0b,0x01,0xcb,0xdc,0x10,0x2a,0xe9,0xf7,0x9d,0x2c,0x29,0xa7,0x7f,0xf1,0xdb,0xc9,0xaf,0xda,0xf1,0x59,0xcd,0x5e,0x10,0x35,0xc9,0xf5,0xe7,0x23,0xe4,0x34,0xc0,0x16,0xd7,0x39,0x54,0xad,0x51,0x49,0xe4,0xfd,0xa7,0xb8,0x85,0x90,0xc7,0x09,0xbc,0xad,0x6f,0x57,0x4a,0xda,0x9c,0xf4,0x49,0xa0,0x44,0x4f,0x78,0x8e,0x47,0x1b,0xd4};
u8 s10[]={0xd6,0xd5,0x15,0xda,0xae,0x0c,0xe6,0xe1,0x0c,0x4f,0x0f,0xe3,0xd2,0x85,0xdb,0x93,0xd3,0x3d,0xf7,0xe6,0xc4,0xda,0x98,0x90,0xbb,0x1c,0x41,0xe9,0x89,0x43,0x85,0xc8,0xce,0x73,0x67,0xed,0xf0,0x18,0x03,0xec,0x6d,0x01,0x54,0x4f,0xaa,0xa9,0xff,0xf6,0x0b,0x05,0x6b,0x44,0x1b,0x91,0x6f,0xf6,0xce,0x22,0x29,0x14,0x75,0x5d,0xd8,0xe5,0x67,0x8f,0x51,0x23,0xae,0x88,0xfa,0xc0,0x36,0xd2,0x60,0x85,0x10,0x7d,0xf0,0x1c,0x31,0x3c,0x6f,0x00,0x14,0x93,0xb3,0xae,0x4c,0xa9,0x21,0xba,0xbc,0x06,0x94,0x50,0xee,0xe5,0x66,0x06,0x2e,0x76,0x29,0xba,0xa4,0x77,0xf7,0x49,0xcd,0xb8,0x2c,0x49,0x08,0x93,0x8c,0xbf,0x6b,0x56,0xe8,0x65,0xbe,0xa4,0x82,0x45,0x6d,0x8f,0x31,0x01};

//SHAAlg = SHA1
// the result shall be false/FAIL/NOK !!
u8 e11[] = {0x01,0x00,0x01};
u8 msg11[] = {0x33,0xdb,0x15,0x02,0xdd,0x1c,0xe0,0x3e,0x93,0xf9,0x84,0xdd,0x59,0xfe,0xb3,0xd6,0x1b,0xf2,0x67,0x4e,0x37,0x4f,0x80,0xb1,0x3c,0xf5,0xaf,0x02,0xf1,0x1e,0x94,0x6f,0x9a,0x95,0x23,0x29,0x76,0x23,0x4c,0x72,0x8c,0x4a,0xdb,0xf8,0xa8,0x36,0x9d,0x61,0xa0,0xf1,0xc4,0x27,0xdb,0xd6,0x8c,0xa6,0x14,0x48,0x1f,0x73,0x5c,0xa4,0xb6,0xf0,0x5e,0x73,0x02,0x1d,0xe7,0xe5,0xca,0xb1,0xa6,0x7b,0xd5,0x6a,0x30,0x03,0x0a,0xa1,0x46,0xc9,0xd6,0x21,0x5b,0x0c,0xce,0x39,0x51,0xaf,0x96,0x10,0x84,0x31,0x01,0x39,0x09,0xdf,0x79,0x87,0x38,0x48,0xa2,0x23,0x67,0xf2,0x3a,0xdb,0xf9,0x4b,0x44,0xbd,0x98,0xe2,0x65,0xe5,0xbe,0xd7,0x8e,0x93,0x7a,0x91,0xdb,0x81,0x71,0xae,0xbb,0x73};
u8 s11[]={0x64,0xe1,0xe8,0x38,0x53,0xb0,0xcb,0xb0,0xb1,0xb1,0x02,0x44,0xca,0x18,0x9b,0xa2,0x84,0x0c,0xe7,0x82,0xdf,0x68,0x50,0x53,0xf4,0xe5,0xa1,0xd6,0x35,0xea,0xac,0x6c,0xaa,0x43,0x9b,0x03,0xfa,0x67,0x44,0x7b,0x22,0x52,0x81,0xde,0xda,0xdd,0xee,0x7a,0x3a,0x12,0x86,0xd1,0x02,0xe8,0xbc,0x42,0x13,0x90,0x41,0x4c,0x29,0x13,0xa3,0xf4,0x02,0xce,0xcf,0xe3,0xa7,0x49,0x75,0x14,0xe7,0x3d,0x79,0xb6,0x12,0x89,0x70,0x62,0x71,0x44,0xcf,0xe3,0xfb,0xc1,0xff,0x82,0x54,0x82,0x99,0x14,0xb9,0x75,0x19,0x3f,0x18,0xde,0x48,0xe5,0x44,0xfe,0x7d,0x03,0x2b,0xc6,0xdc,0x4d,0x1a,0x3b,0x08,0x8f,0x08,0x80,0x99,0xd7,0x1a,0x33,0x57,0xf8,0xb9,0x36,0x55,0x44,0x94,0xad,0xf2,0x13};


//SHAAlg = SHA256
u8 e8[] = {0x11};
u8 msg8[] = {0x1b,0x6e,0x84,0x44,0x6a,0x79,0xb8,0xe0,0x2d,0xac,0xeb,0x2f,0xcf,0x59,0x6d,0x4b,0xd3,0x84,0x86,0x6d,0x5d,0x52,0x19,0x04,0xf4,0xbe,0x81,0x04,0x86,0x8e,0xbf,0x81,0xac,0x85,0xd7,0x7c,0x30,0xdb,0x77,0xfd,0xcd,0xea,0xda,0x62,0x35,0x2a,0xec,0xf6,0x59,0x5f,0xaf,0xc5,0xe4,0x11,0xdd,0xaf,0x08,0x3d,0xcf,0xbc,0x7e,0x4a,0x9d,0xaf,0xc8,0x3e,0x87,0xde,0xba,0x32,0x93,0x40,0x38,0x04,0x78,0xc8,0x41,0x4b,0xbb,0xf1,0x2d,0x90,0x18,0x9b,0x32,0xbb,0x23,0x15,0x2d,0xcb,0x2f,0x7b,0x9f,0xca,0x6f,0x42,0xf6,0x00,0x5b,0x11,0x0f,0x68,0x55,0xd2,0xf8,0x60,0x8d,0x0a,0xfa,0xa4,0x22,0x65,0xd7,0x7d,0x8a,0x96,0x50,0x36,0x33,0x5d,0xea,0xd0,0x6a,0xe9,0xf2,0xf7,0x7d,0x61};
u8 s8[] ={0x17,0x89,0x9c,0x0e,0x55,0x42,0x91,0x8c,0xf3,0x9a,0x15,0x08,0x82,0xf7,0x8f,0x70,0x47,0x86,0x2c,0x5c,0x70,0x78,0x26,0x1b,0x60,0xe9,0x99,0xf2,0xa6,0xa7,0x5e,0xa8,0x41,0x2c,0xc3,0x03,0xdd,0x9d,0xb3,0xc7,0xa0,0x1d,0x47,0xc6,0x15,0x6b,0xca,0xaa,0x41,0x5a,0x68,0x80,0x2e,0x4b,0x96,0x1e,0x38,0x0e,0xad,0x99,0xac,0x8e,0x66,0x10,0x06,0xfd,0x8d,0xe0,0xef,0x49,0x4e,0x57,0xa1,0x17,0x95,0x15,0xaa,0x01,0xd0,0x8a,0x31,0x69,0xb4,0xef,0x9f,0xef,0x15,0x76,0xb2,0xac,0x44,0x69,0x8a,0x17,0x90,0x13,0x90,0x03,0x9a,0x2c,0x90,0x5b,0x45,0xad,0xc5,0xee,0x58,0xf0,0xd6,0x82,0x78,0x4a,0xf1,0x7f,0x7f,0x60,0x50,0xad,0x9c,0x8b,0x9c,0xd0,0x9b,0x77,0x1a,0x1a,0x0b,0xe5};

//SHAAlg = SHA256
// the result shall be false/FAIL/NOK !!
u8 e12[] = {0x01,0x00,0x01};
u8 msg12[] = {0x45,0xe1,0x07,0x14,0x21,0x4f,0xf8,0xd2,0x76,0xe2,0xc5,0x13,0xf7,0xd2,0xdb,0x64,0x8e,0xb2,0x8d,0x98,0x4e,0x97,0xac,0x10,0xaa,0x7c,0x58,0x3a,0xe4,0xe5,0x15,0x58,0xc8,0xc3,0x22,0x83,0x99,0x98,0x06,0xef,0x4c,0xdb,0x6b,0x70,0xf4,0x9e,0x2f,0x3d,0x7e,0x6e,0xb9,0xf5,0x9e,0x7b,0x89,0xdf,0x09,0xf9,0x13,0x76,0xe5,0xc5,0xce,0x25,0x7d,0x4c,0x88,0x4f,0x3a,0xa9,0xfc,0x92,0xcf,0x0d,0xa6,0x4d,0xb3,0x64,0xd6,0x5f,0xd4,0x35,0x04,0x32,0x8a,0xca,0x63,0xf9,0xc9,0x92,0xb8,0x35,0x9c,0xc3,0x6d,0x7e,0xce,0x43,0xe1,0x80,0xea,0xc9,0x03,0x44,0x67,0x40,0x1f,0xb1,0x1c,0x6c,0xf8,0x52,0xfa,0xcf,0x16,0x59,0xf9,0xce,0x61,0xe4,0x53,0x10,0xef,0x80,0xf1,0x27,0x1b,0xeb};
u8 s12[] = {0x51,0x13,0xcd,0x40,0x71,0xa7,0x60,0xd4,0x3a,0xdb,0x02,0x6e,0xfb,0xd3,0x69,0xe9,0x7a,0x52,0x55,0x35,0x3c,0xde,0x1c,0x1e,0x97,0x8b,0xa8,0xb0,0xd3,0x50,0x41,0xba,0xb4,0x96,0x18,0x93,0xc2,0x30,0xca,0x4d,0x80,0xff,0x7e,0xcb,0x6a,0x30,0x1a,0x0e,0xb7,0xf8,0x96,0xb9,0xec,0x32,0xf7,0xcc,0x25,0x89,0xb0,0x87,0xba,0x18,0x1c,0x54,0xa7,0x09,0x06,0x29,0x80,0xbf,0xb9,0x12,0xc6,0xdb,0x55,0xc1,0x07,0x3e,0x83,0x8c,0xfc,0x33,0xcb,0xc1,0x13,0x89,0x1c,0xbd,0xcd,0x12,0xfb,0xfc,0xc6,0xba,0xe9,0xd4,0xf1,0xc2,0xd8,0x31,0xcd,0x3c,0x4c,0x86,0x10,0xf5,0xa2,0x54,0x50,0x77,0xfe,0x75,0xcb,0x9b,0xef,0xfd,0xfb,0x73,0xdf,0xda,0xa9,0x76,0x6a,0x3c,0xd8,0xf3,0x7d,0xa6};

//SHAAlg = SHA256
// the result shall be false/FAIL/NOK !!
u8 e13[] = {0x03};
u8 msg13[] = {0xde,0x6a,0x56,0xfe,0x2f,0xd2,0x35,0x53,0x98,0x9c,0x02,0xab,0x90,0xf0,0x92,0x99,0x32,0x0e,0x76,0x76,0x3e,0x3f,0x22,0xf8,0x63,0x0a,0x4f,0x06,0xbe,0xaa,0x9d,0xcb,0x9e,0xc0,0x7d,0x0a,0x8a,0x46,0x4e,0xb1,0x85,0xc4,0xc6,0xb0,0x90,0xc6,0x94,0x0b,0x71,0x8d,0x43,0x2e,0xb3,0x05,0x62,0x82,0xee,0xf7,0xe2,0x3d,0x48,0x80,0xbf,0x7e,0x3c,0xc2,0xe3,0x99,0x9a,0xd9,0x47,0xaf,0xcf,0x10,0x5b,0x83,0x67,0x55,0xa8,0x88,0xd0,0xeb,0xb3,0x3f,0x61,0x5f,0x25,0xbf,0x9a,0xbd,0x2a,0x95,0xae,0x03,0x17,0xcf,0x3e,0xd6,0x4f,0x54,0x68,0x74,0x67,0x77,0x00,0xea,0x88,0xcb,0x1d,0x87,0x15,0x38,0xd8,0x90,0x8e,0x4e,0x50,0x35,0xb5,0xda,0xf2,0xc4,0xef,0xb7,0xf7,0x1d,0xec,0xe7};
u8 s13[] = {0x32,0xe0,0xb6,0x11,0xd6,0xfb,0xe5,0xc2,0x0b,0x4d,0x7f,0x5a,0x38,0xe9,0x2a,0x5c,0xe9,0x57,0xdf,0x4e,0x37,0x20,0x46,0x71,0xdb,0xa0,0xe0,0xee,0x6e,0xf4,0xe8,0xa6,0xa8,0x53,0x42,0x68,0x88,0x07,0xbd,0x83,0x37,0x72,0x86,0xe3,0x82,0xed,0xdb,0x9b,0xb8,0xe3,0x39,0xea,0x5c,0xb3,0xa7,0xd9,0x8c,0x2a,0xb9,0x4c,0x37,0xb7,0x2f,0x40,0xea,0x36,0xa5,0x3a,0x5d,0x44,0x3a,0xa3,0xc8,0xf0,0x3c,0x6e,0xdf,0x9a,0x95,0xbd,0x8b,0x53,0xb6,0x36,0x4b,0x9a,0xde,0xc5,0xc2,0x5e,0x8f,0x1d,0x0d,0x96,0x6e,0x52,0xea,0x0b,0x7c,0xfe,0x15,0xde,0xb6,0xca,0xde,0x7b,0xd9,0x2f,0x63,0x91,0x99,0xa8,0x13,0x73,0x36,0x95,0x85,0xd6,0x4d,0x25,0xf1,0xa6,0x12,0x02,0xf7,0xdc,0x1d,0x8d};

//SHAAlg = SHA256
// the result shall be false/FAIL/NOK !!
u8 e14[] = {0x03};
u8 msg14[] = {0xd6,0xfd,0xc4,0x2a,0x79,0xf7,0x6a,0xb8,0x87,0xe3,0xa8,0x3b,0x8e,0x62,0xa9,0xfc,0x3e,0xbb,0xaa,0x17,0xd5,0x7e,0x0b,0x39,0xda,0x67,0xa6,0xa9,0x0e,0x84,0x5f,0x85,0xa0,0x9a,0xfc,0x4f,0xa0,0xc6,0x38,0xa8,0xb6,0x60,0x12,0x5a,0x14,0x24,0x6b,0x9c,0xa9,0x94,0xd0,0x92,0x97,0x98,0x95,0x14,0xe8,0x68,0x23,0xb0,0x7c,0xab,0x92,0xf2,0x46,0xe1,0x7b,0xe2,0xb9,0xfe,0x07,0xcf,0x7c,0x57,0x4c,0x4b,0x65,0xc2,0xda,0x77,0xa5,0xf9,0x90,0x81,0x40,0x40,0xb5,0x6a,0xc1,0x48,0x44,0x0d,0x2b,0x52,0x86,0x5d,0x32,0x97,0xe6,0xee,0xab,0xe8,0x02,0xb7,0x42,0x92,0xfe,0x16,0x6b,0x84,0x1d,0x14,0x9b,0xb4,0x92,0xeb,0xb7,0xbe,0x93,0xc5,0xcd,0xce,0xb0,0xc7,0x02,0xc1,0x63,0x4e};
u8 s14[] = {0xab,0x76,0x6b,0xd2,0xba,0x64,0xc7,0x1c,0x5f,0x94,0x46,0x00,0xd0,0xf1,0x75,0x16,0xd4,0x4f,0x82,0x6d,0xa9,0x35,0xf2,0x7e,0xa0,0xa9,0x2c,0x90,0xb4,0xf5,0x35,0x2d,0xc7,0x5f,0x75,0x98,0x3c,0x96,0xdc,0xc3,0x55,0xe0,0x00,0x78,0xda,0xdf,0x36,0x92,0x11,0x4f,0x79,0x5e,0xb1,0xcf,0xf7,0xd1,0x99,0x14,0x7a,0x9a,0xfd,0x48,0x48,0x50,0xd6,0xb8,0x78,0xf7,0x3a,0xcb,0x2b,0xab,0x12,0x00,0xe8,0xdb,0x22,0x75,0xcc,0xd5,0xde,0xa6,0x92,0xe1,0x6d,0x0d,0x4e,0xc3,0x79,0x69,0xee,0xb2,0xc6,0x65,0xcc,0x3f,0xe1,0xf3,0xfd,0xda,0x10,0xfc,0x74,0xfc,0x83,0x5d,0xc2,0x11,0x7b,0xa7,0x10,0x02,0xba,0x15,0x4c,0x38,0xdb,0xc0,0xf0,0x26,0xa9,0xfc,0x83,0x49,0x4d,0x5c,0x23,0xae};
u8 e15[] = {0x03};
u8 n15[]={0xb8,0x2d,0x9d,0x45,0xdd,0xb8,0xe3,0x9d,0x1a,0x43,0xb0,0x35,0x5f,0x00,0x37,0xf6,0x29,0x5a,0xe7,0xd1,0xe0,0x56,0x98,0x7e,0xb3,0x16,0xa6,0x0f,0xa0,0x44,0xf1,0xc0,0x35,0x60,0x94,0xbe,0x60,0xb9,0xc8,0xda,0xd3,0xcf,0x37,0x57,0x6c,0x24,0x60,0x60,0xdd,0x13,0x1b,0xf1,0x7e,0xd0,0x36,0xbe,0xb6,0xf0,0x67,0x49,0xc7,0xbe,0x87,0xd1,0xc2,0x87,0xfe,0xc1,0xf0,0x1e,0x51,0xed,0xa7,0x6c,0xdb,0x68,0xef,0x6f,0xe0,0xfa,0x56,0x2d,0x8e,0x76,0xcc,0x87,0x09,0x24,0x3b,0x3c,0xdb,0x87,0xe4,0xf7,0x51,0xfa,0x4d,0x47,0xb3,0x71,0xfb,0xb9,0x7c,0x59,0xc2,0x7f,0x54,0x50,0x33,0x9f,0xb2,0xf6,0xd9,0x3f,0x6f,0x69,0x9d,0x37,0x78,0x1b,0xcb,0x75,0x71,0x2b,0x80,0xd5,0xb6,0xa9};
u8 msg15[] = {0x92,0x63,0x54,0x82,0x65,0x23,0xa3,0x29,0xf7,0x20,0xdc,0x2e,0x15,0x7a,0xee,0xd5,0xc8,0xac,0xba,0x8d,0x91,0xbf,0x75,0xc5,0xf3,0xbe,0x4d,0x00,0x32,0x69,0x4f,0x2c,0x5b,0x2d,0x88,0x2f,0x84,0x54,0x6a,0xc4,0x55,0x7a,0x72,0x85,0xc7,0x40,0x08,0x48,0x2c,0x44,0xa7,0xaf,0x70,0x50,0x3d,0xfb,0x9e,0xd1,0xd5,0x21,0xa5,0x8b,0x73,0x20,0x5d,0x8c,0x3f,0x91,0xc5,0x5e,0xe6,0x80,0x8f,0x81,0x3e,0x7a,0xde,0x18,0x29,0xe7,0x4e,0xe3,0xbb,0x9b,0x35,0x6d,0x9f,0xa7,0x28,0x87,0xb6,0x75,0xc1,0xf4,0x02,0x14,0xa0,0x66,0xc3,0xd0,0xb0,0xaa,0xdf,0x06,0xab,0x1f,0x87,0x36,0xe1,0x6c,0x18,0x5a,0x35,0x72,0x3f,0x76,0x68,0x80,0x61,0x71,0x9a,0xc6,0x3a,0x23,0x0d,0x0d,0xc4,0xaf};
u8 s15[] = {0xa2,0xb3,0x59,0xce,0x04,0x94,0xa8,0x6d,0x75,0xfc,0xaa,0x86,0xcb,0xa8,0xd0,0x5b,0x96,0x8f,0xdc,0x63,0x95,0xc0,0xa5,0xd9,0x74,0x15,0xec,0xa9,0x6a,0xeb,0x56,0x64,0x3a,0x77,0x47,0xff,0x62,0x30,0x51,0x0f,0x0d,0xbe,0x20,0x5a,0x02,0xa0,0xc3,0x75,0x7e,0xf5,0x9a,0xaa,0xe8,0x0f,0x94,0xcd,0xbd,0xd5,0xe2,0xf7,0x39,0x7a,0x08,0x21,0xd1,0x49,0x9b,0x36,0xfe,0x31,0x0e,0xbc,0xfc,0xe2,0x7c,0xec,0x1e,0xea,0xf9,0xb0,0x91,0x74,0xaf,0x0b,0xd4,0xdd,0x84,0x76,0x98,0xe3,0x13,0xde,0x16,0xe2,0x63,0xc7,0xe5,0x74,0x26,0x36,0xaa,0x7a,0x18,0x39,0xbe,0x86,0x5f,0xf4,0x59,0x6b,0xba,0x38,0x96,0x65,0x49,0x09,0x17,0xa2,0x70,0xda,0xea,0x65,0x4f,0x01,0x23,0xb8,0xbb,0x95};


//rsa pkcs1 test vectors (www.rsa.com, pkcs1 web page, step-by-step example; pss-int.txt)
u8 n101[]={0xa2,0xba,0x40,0xee,0x07,0xe3,0xb2,0xbd,0x2f,0x02,0xce,0x22,0x7f,0x36,0xa1,0x95,
	   0x02,0x44,0x86,0xe4,0x9c,0x19,0xcb,0x41,0xbb,0xbd,0xfb,0xba,0x98,0xb2,0x2b,0x0e,
	   0x57,0x7c,0x2e,0xea,0xff,0xa2,0x0d,0x88,0x3a,0x76,0xe6,0x5e,0x39,0x4c,0x69,0xd4,
	   0xb3,0xc0,0x5a,0x1e,0x8f,0xad,0xda,0x27,0xed,0xb2,0xa4,0x2b,0xc0,0x00,0xfe,0x88,
	   0x8b,0x9b,0x32,0xc2,0x2d,0x15,0xad,0xd0,0xcd,0x76,0xb3,0xe7,0x93,0x6e,0x19,0x95,
	   0x5b,0x22,0x0d,0xd1,0x7d,0x4e,0xa9,0x04,0xb1,0xec,0x10,0x2b,0x2e,0x4d,0xe7,0x75,
	   0x12,0x22,0xaa,0x99,0x15,0x10,0x24,0xc7,0xcb,0x41,0xcc,0x5e,0xa2,0x1d,0x00,0xee,
	   0xb4,0x1f,0x7c,0x80,0x08,0x34,0xd2,0xc6,0xe0,0x6b,0xce,0x3b,0xce,0x7e,0xa9,0xa5,
};

 u8 e101[]={0x01, 0x00,0x01 };

//msg len=114

u8 msg101[]={0x85,0x9e,0xef,0x2f,0xd7,0x8a,0xca,0x00,0x30,0x8b,0xdc,0x47,0x11,0x93,0xbf,0x55,
	     0xbf,0x9d,0x78,0xdb,0x8f,0x8a,0x67,0x2b,0x48,0x46,0x34,0xf3,0xc9,0xc2,0x6e,0x64,
	     0x78,0xae,0x10,0x26,0x0f,0xe0,0xdd,0x8c,0x08,0x2e,0x53,0xa5,0x29,0x3a,0xf2,0x17,
	     0x3c,0xd5,0x0c,0x6d,0x5d,0x35,0x4f,0xeb,0xf7,0x8b,0x26,0x02,0x1c,0x25,0xc0,0x27,
	     0x12,0xe7,0x8c,0xd4,0x69,0x4c,0x9f,0x46,0x97,0x77,0xe4,0x51,0xe7,0xf8,0xe9,0xe0,
	     0x4c,0xd3,0x73,0x9c,0x6b,0xbf,0xed,0xae,0x48,0x7f,0xb5,0x56,0x44,0xe9,0xca,0x74,
	     0xff,0x77,0xa5,0x3c,0xb7,0x29,0x80,0x2f,0x6e,0xd4,0xa5,0xff,0xa8,0xba,0x15,0x98,
	     0x90,0xfc };

u8 s101[]={0x8d,0xaa,0x62,0x7d,0x3d,0xe7,0x59,0x5d,0x63,0x05,0x6c,0x7e,0xc6,0x59,0xe5,0x44,
	   0x06,0xf1,0x06,0x10,0x12,0x8b,0xaa,0xe8,0x21,0xc8,0xb2,0xa0,0xf3,0x93,0x6d,0x54,
	   0xdc,0x3b,0xdc,0xe4,0x66,0x89,0xf6,0xb7,0x95,0x1b,0xb1,0x8e,0x84,0x05,0x42,0x76,
	   0x97,0x18,0xd5,0x71,0x5d,0x21,0x0d,0x85,0xef,0xbb,0x59,0x61,0x92,0x03,0x2c,0x42,
	   0xbe,0x4c,0x29,0x97,0x2c,0x85,0x62,0x75,0xeb,0x6d,0x5a,0x45,0xf0,0x5f,0x51,0x87,
	   0x6f,0xc6,0x74,0x3d,0xed,0xdd,0x28,0xca,0xec,0x9b,0xb3,0x0e,0xa9,0x9e,0x02,0xc3,
	   0x48,0x82,0x69,0x60,0x4f,0xe4,0x97,0xf7,0x4c,0xcd,0x7c,0x7f,0xca,0x16,0x71,0x89,
	   0x71,0x23,0xcb,0xd3,0x0d,0xef,0x5d,0x54,0xa2,0xb5,0x53,0x6a,0xd9,0x0a,0x74,0x7e };


// nist cmvp rsa pkcs1 pss, salt len=0
// all answers shall be nok
 u8 n110[] = {0xee,0x63,0x2b,0x5a,0xb2,0x4d,0xbf,0x1f,0xdc,0xe2,0x73,0x76,0xaa,0x3f,0xbc,0x1d,0x70,0x4d,0x1b,0x0a,0x31,0x01,0x20,0x92,0x6c,0x4a,0x16,0xec,0x0c,0x1d,0xd8,0x1b,0xd5,0x6e,0x07,0xf2,0xcb,0xe7,0x74,0xcd,0x93,0x6e,0xdc,0x2a,0xd7,0x5a,0xa7,0xa5,0xba,0xd8,0x6c,0xc8,0x89,0x02,0x3e,0xf5,0xac,0xb0,0x48,0x76,0x9c,0x6d,0x7a,0x20,0x48,0x1d,0x35,0x3a,0x8d,0x38,0x7f,0xae,0x99,0xc8,0xc5,0xd3,0xf5,0x3b,0x97,0xf6,0x8a,0x91,0x92,0xa1,0x85,0x89,0x0d,0xd3,0xe7,0xd8,0xf6,0x0f,0x74,0x23,0xb1,0x89,0xda,0x15,0x02,0x39,0xbd,0x0a,0x80,0x7b,0x52,0x0a,0xe9,0xf4,0xce,0x73,0x41,0x47,0xef,0x82,0x54,0x9d,0xe3,0xae,0xb5,0xb3,0x43,0x51,0x68,0x4f,0x45,0xe3,0x6f,0xc3};

 u8 e110[] = {0x03};
 u8 msg110[]={0xa7,0x30,0x16,0x00,0xdf,0x1b,0xcf,0xaf,0x8a,0x36,0x66,0x6f,0xf8,0x1f,0x55,0xe3,0x15,0xa0,0x8d,0x4c,0xec,0x26,0x15,0x9f,0x6d,0x75,0xf5,0xdb,0x6d,0x9b,0x52,0x99,0xee,0x22,0xda,0xe4,0xa1,0x8a,0x63,0x4c,0xa9,0xf7,0xce,0x36,0xa2,0x26,0x32,0x76,0xe2,0xa5,0x37,0x20,0xfe,0x44,0xbf,0x9a,0x90,0xc7,0xcc,0xf6,0x38,0xdd,0x9e,0x7f,0xe1,0x56,0x1b,0x92,0x46,0x90,0x74,0xb0,0xb4,0x32,0x06,0xd0,0x11,0x1d,0x7e,0xfa,0x1d,0xa0,0x41,0x11,0xf8,0xeb,0x0b,0xf1,0xe5,0xc7,0xd5,0xba,0x4d,0x84,0xfd,0x6a,0x07,0x32,0xa1,0xb2,0xd6,0x14,0x4b,0x02,0x33,0x51,0xd4,0xe7,0x4d,0xed,0x82,0x96,0x4f,0xf8,0x74,0xc9,0xe1,0x05,0x40,0xc9,0xf1,0xde,0xda,0xcc,0xb3,0x76,0xb8,0x82};
 u8 s110[]={0x55,0x45,0x02,0xc4,0xe5,0xb9,0x38,0x29,0x52,0x6b,0xc2,0x8b,0xdc,0xeb,0xbf,0x7f,0xe2,0x21,0xcb,0xca,0x18,0xd6,0xf8,0x1d,0x27,0x22,0x3d,0x00,0xf0,0xc0,0x63,0xb3,0x2f,0x59,0xd8,0xe8,0xa0,0x29,0x68,0x9a,0x3b,0x66,0x16,0x70,0xa2,0x71,0xa8,0x39,0xd8,0x4a,0xd3,0xaa,0x16,0xb1,0x69,0x4a,0xd8,0x04,0x4f,0xec,0xec,0x20,0x0f,0x93,0xd1,0xf1,0xfc,0x5f,0x03,0x67,0xa3,0x3e,0x17,0x3b,0xde,0xf0,0xee,0x2c,0x49,0xe4,0x5a,0xdc,0xe4,0x1e,0xb3,0x6f,0x22,0x67,0xaf,0xed,0xd4,0x22,0xa0,0xbb,0x1d,0xc5,0xc1,0x64,0x2d,0x4a,0x79,0x70,0x11,0xcf,0x61,0x27,0x9d,0xb7,0xd2,0xa4,0x21,0xa1,0x17,0x18,0x56,0x14,0x14,0x4e,0x73,0x61,0xe6,0x04,0xa9,0x9f,0xe3,0x4b,0x77,0x00};

 u8 e111[] = {0x01,0x00,0x01};
 u8 msg111[]={0xa5,0xf1,0x57,0x71,0xb0,0xfd,0xe6,0xee,0x03,0xe8,0xb8,0xf9,0x93,0x63,0x0c,0xf0,0x1a,0xca,0x1e,0x29,0x62,0x56,0x90,0xcf,0xc0,0x94,0x0e,0xec,0xde,0x16,0x32,0xc6,0xbe,0x68,0xa5,0x6f,0xfc,0x45,0x88,0x98,0x54,0x0b,0x12,0xa6,0x63,0x6d,0x7a,0x08,0xb2,0x68,0x17,0xc7,0xf0,0x78,0xc6,0x5e,0x7f,0x0b,0x8c,0xcd,0x33,0x36,0x7c,0xe9,0x56,0xa7,0xdb,0xf6,0xef,0xdb,0x83,0x77,0x43,0x91,0x85,0x45,0x9d,0x7e,0x12,0xdf,0x4b,0x42,0x9c,0x01,0xe9,0x9b,0x38,0x78,0xe2,0xd8,0x47,0x34,0x33,0x91,0x55,0x9f,0x72,0x96,0x41,0x2d,0x0f,0x25,0x9e,0x34,0xdb,0x60,0x5a,0xff,0xc6,0xfd,0x9d,0x1e,0xed,0x40,0xf4,0xff,0xd4,0x26,0xaf,0xc3,0xef,0xe4,0x88,0x4a,0x68,0x8f,0x85,0x90};
 u8 s111[] = {0x75,0x00,0x18,0x75,0x75,0x44,0xa5,0x19,0xd7,0xa2,0x25,0x89,0xce,0x08,0xc5,0x37,0x92,0xc9,0xe3,0x27,0x3f,0xb3,0xf7,0x4d,0xb8,0xff,0x0f,0xf1,0xab,0x2d,0x29,0x90,0x49,0x05,0xa6,0x77,0xe1,0x86,0xa7,0x02,0x4c,0x43,0x6d,0x18,0x0c,0x9d,0x2f,0x03,0x1e,0xea,0xab,0xac,0xa6,0xcc,0x6a,0xf5,0xa5,0xab,0x63,0x8a,0xea,0x82,0x05,0x53,0x85,0xdd,0x2e,0x19,0x7a,0x87,0x6c,0x55,0xda,0x63,0xae,0x7a,0xcd,0x4b,0xd9,0x9f,0x70,0x31,0x95,0x83,0xba,0x52,0x09,0x10,0x77,0xa1,0x10,0xb3,0x00,0x51,0x24,0x3d,0x21,0x07,0xb1,0x91,0x2c,0xac,0xa6,0x14,0x14,0xba,0xd6,0x6b,0x8c,0x22,0x9d,0x39,0x1b,0x8c,0x85,0x27,0xcd,0x13,0xb9,0xea,0xc2,0x8e,0x90,0xe6,0xbb,0x76,0x15,0x57};

  //RSA PKCS1 PSS SHA256
   u8 e100[] = {0x03};
  u8 msg100[]={0x3f,0xf7,0xeb,0x67,0xd8,0x09,0x5b,0x63,0x46,0xd9,0xdd,0x4b,0x7f,0x94,0xb3,0xec,0x72,0x80,0xe3,0xc5,0xeb,0x47,0x39,0x03,0xb7,0x93,0x8b,0xb0,0x08,0xda,0x40,0x27,0x1b,0x7c,0x13,0xcb,0x17,0x0b,0x15,0xf8,0x39,0xe9,0xf1,0x3a,0x2e,0x19,0x74,0xbd,0xc0,0x4f,0x4d,0x05,0xb5,0x49,0x11,0xdf,0xf4,0x62,0x82,0x98,0xea,0x65,0x10,0x6c,0x2c,0x9f,0xa0,0x41,0x5e,0x38,0x8d,0x96,0x53,0xc3,0xec,0xb6,0x75,0x13,0x15,0x31,0x68,0x50,0x5f,0x8c,0xea,0x4b,0x2a,0x38,0xfe,0x0f,0x23,0xc1,0x49,0xb9,0xc3,0x48,0xbc,0x89,0x19,0x33,0x73,0x38,0xca,0x23,0xdd,0x8c,0x56,0x26,0x1e,0x2b,0x9c,0x2f,0xb1,0xad,0xa1,0xc3,0x52,0xf4,0x8d,0xf4,0x1b,0xc0,0xf6,0x93,0xed,0x7e,0x61,0xa2};
   u8 s100[]={0x41,0x9d,0x74,0x29,0x64,0xe5,0x23,0x1b,0x23,0x53,0x46,0x2d,0x37,0x22,0x96,0x98,0x24,0xf5,0x23,0xe2,0xed,0x69,0xc1,0xc7,0x37,0xbc,0xfc,0x67,0x14,0xab,0xff,0x9a,0xa2,0x75,0xe8,0xb4,0x63,0xd8,0xbc,0xa3,0x89,0xad,0xd0,0x72,0x66,0x11,0x35,0x79,0x3b,0x73,0x69,0x4c,0x24,0x4f,0x2e,0x59,0x15,0x36,0x1e,0x5c,0x6d,0x96,0xdf,0xc6,0x4c,0x84,0xdf,0x61,0xd2,0x69,0xe1,0x38,0xd4,0xa4,0xe7,0x7e,0x2b,0x7f,0x94,0xe8,0xf7,0xdd,0xce,0xc7,0x70,0x78,0xa6,0xed,0xea,0xb2,0xf0,0x13,0xbf,0xce,0xbc,0x2f,0xb2,0xc7,0xab,0x49,0x7d,0x57,0x1e,0x18,0x47,0x4b,0x8d,0xc9,0x53,0x9a,0xd6,0x2c,0x2d,0xf8,0xec,0xca,0xc5,0xfe,0x21,0xb9,0xa7,0x34,0x7f,0xfe,0xa8,0xb1,0xcd,0xf4};



int check_ssa_pss_sha1(u8 *signature, u8 *msg, u32 msg_length, ucl_rsa_public_key_t *keyPu, u32 salt_length)
{
  int err;
  u8 hash[UCL_SHA1_HASHSIZE];
  err=ucl_sha1(hash,msg,msg_length);
  if(UCL_OK!=err)
    {
      return(UCL_ERROR);
    }
  err=ucl_pkcs1_ssa_pss_sha1_verify(signature,msg,msg_length,keyPu,salt_length);
  if(UCL_OK!=err)
    {
      PRINTF("1.\n");
      return(UCL_ERROR);
    }
  err=ucl_pkcs1_ssa_pss_verify(signature,hash,UCL_SHA1_HASHSIZE,keyPu,salt_length);
  if(UCL_OK!=err)
    {
      PRINTF("2.\n");
      return(UCL_ERROR);
    }
  return(UCL_OK);
}

int test_pkcs1_kat(void)
{
#define IDF_SHA1 0
#define IDF_SHA256 1
#define IDF_SHA224 2
#define IDF_SHA384 3
#define IDF_SHA512 4
#define IDF_MD5 5
  u8 hash[UCL_SHA256_HASHSIZE];
  u8 resu[128];
  ucl_rsa_public_key_t keyPu;
  ucl_rsa_private_key_t keyPr;
  int i;
  u32 sl;
  int err;
  PRINTF("RSA PKCS1 testing----------\n");
  //RSA PSS verification
  // rsa pkcs 1024
  keyPu.public_exponent_length=3;
  for(i=0;i<(int)keyPu.public_exponent_length;i++)
    keyPu.public_exponent[i]=e101[i];
  keyPu.modulus_length=128;
  for(i=0;i<(int)keyPu.modulus_length;i++)
    keyPu.modulus[i]=n101[i];
  sl=20;
  err=check_ssa_pss_sha1((u8*)s101,(u8*)msg101,114, &keyPu,sl);
  if(err!=UCL_OK)
    {
      PRINTF("ERROR on n101\n");
      return(UCL_ERROR);
    }
  //NIST CMVP (shall be false)
  keyPu.public_exponent_length=1;
  for(i=0;i<(int)keyPu.public_exponent_length;i++)
    keyPu.public_exponent[i]=e110[i];
  keyPu.modulus_length=128;
  for(i=0;i<(int)keyPu.modulus_length;i++)
    keyPu.modulus[i]=n110[i];
  sl=0;
  err=check_ssa_pss_sha1((u8*)s110,(u8*)msg110,sizeof(msg110), &keyPu,sl);
  if(err==UCL_OK)
    {
      PRINTF("ERROR on n110\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.PSS.10-SHA1 OK (FAILED AS EXPECTED)\n");
  keyPu.public_exponent_length=3;
  for(i=0;i<(int)keyPu.public_exponent_length;i++)
    keyPu.public_exponent[i]=e111[i];

  ucl_sha256(hash,(u8*)msg100,sizeof(msg100));
  err=ucl_pkcs1_ssa_pss_verify((u8*)s100,hash,UCL_SHA256_HASHSIZE, &keyPu,sl);
  if(err==UCL_OK)
    {
    PRINTF("ERROR on s100 (pss sha256)\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.PSS.11-SHA256 OK (FAILED AS EXPECTED)\n");
  err=ucl_pkcs1_ssa_pss_sha256_verify((u8*)s100,(u8*)msg100,sizeof(msg100), &keyPu,sl);
  if(err==UCL_OK)
    {
    PRINTF("ERROR on s100 (pss sha256)\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.PSS.11-SHA256 OK (FAILED AS EXPECTED)\n");
  //pkcs1 v15 verification
  keyPu.modulus_length=128;
  for(i=0;i<128;i++)
    keyPu.modulus[i]=n3[i];
  keyPu.public_exponent_length=1;
  keyPu.public_exponent[0]=3;
  //pkcs ssa pkcs1.5

  ucl_sha1(hash,msg3,128);
  err=ucl_pkcs1_ssa_pkcs1v15_verify(s3, hash,UCL_SHA1_HASHSIZE, &keyPu);
  if(err!=0)
    {
      PRINTF("ERROR PKCS1 -N3-MSG3: %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.1-SHA1 OK\n");
  err=ucl_pkcs1_ssa_pkcs1v15_sha1_verify(s3, msg3, 128, &keyPu);
  if(err!=0)
    {
      PRINTF("ERROR PKCS1 -N3-MSG3: %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.1-SHA1 OK\n");
  keyPu.public_exponent_length=3;
  for(i=0;i<(int)keyPu.public_exponent_length;i++)
    keyPu.public_exponent[i]=e4[i];
  //pkcs ssa pkcs1.5

  ucl_sha1(hash,msg4,128);
  err=ucl_pkcs1_ssa_pkcs1v15_verify (s4, hash,UCL_SHA1_HASHSIZE, &keyPu);
  if(err!=UCL_OK)
    {
      PRINTF("ERROR PKCS1 -N4-MSG4: %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.2-SHA1 OK\n");
  err=ucl_pkcs1_ssa_pkcs1v15_sha1_verify (s4, msg4, 128, &keyPu);
  if(err!=UCL_OK)
    {
      PRINTF("ERROR PKCS1 -N4-MSG4: %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.2-SHA1 OK\n");
  keyPu.public_exponent_length=1;
  for(i=0;i<(int)keyPu.public_exponent_length;i++)
    keyPu.public_exponent[i]=e5[i];
  //pkcs ssa pkcs1.5

  ucl_sha1(hash,msg5,128);
  err=ucl_pkcs1_ssa_pkcs1v15_verify (s5, hash,UCL_SHA1_HASHSIZE, &keyPu);
  if(err!=UCL_OK)
    {
      PRINTF("ERROR PKCS1 -N5-MSG5: %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.3-SHA1 OK\n");
  err=ucl_pkcs1_ssa_pkcs1v15_sha1_verify (s5, msg5, 128, &keyPu);
  if(err!=UCL_OK)
    {
      PRINTF("ERROR PKCS1 -N5-MSG5: %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.3-SHA1 OK\n");
  keyPu.public_exponent_length=1;
  for(i=0;i<(int)keyPu.public_exponent_length;i++)
    keyPu.public_exponent[i]=e5[i];
  msg5[0]=msg5[0]+1;
  //pkcs ssa pkcs1.5

  ucl_sha1(hash,msg5,128);
  err=ucl_pkcs1_ssa_pkcs1v15_verify (s5, hash,UCL_SHA1_HASHSIZE, &keyPu);
  if(err==UCL_OK)
    {
      PRINTF("ERROR PKCS1 -N5-modified MSG5: SHALL HAVE FAILED %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.4-SHA1 OK  (FAILED AS EXPECTED)\n");
  err=ucl_pkcs1_ssa_pkcs1v15_sha1_verify (s5, msg5, 128, &keyPu);
  if(err==UCL_OK)
    {
      PRINTF("ERROR PKCS1 -N5-modified MSG5: SHALL HAVE FAILED %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.4-SHA1 OK  (FAILED AS EXPECTED)\n");
  keyPu.public_exponent_length=1;
  for(i=0;i<(int)keyPu.public_exponent_length;i++)
    keyPu.public_exponent[i]=e6[i];
  //pkcs ssa pkcs1.5

  ucl_sha256(hash,msg6,128);
  err=ucl_pkcs1_ssa_pkcs1v15_verify (s6, hash,UCL_SHA256_HASHSIZE, &keyPu);
  if(err!=UCL_OK)
    {
      PRINTF("ERROR PKCS1 -N6-MSG6: %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.5-SHA256 OK\n");
  err=ucl_pkcs1_ssa_pkcs1v15_sha256_verify (s6, msg6, 128, &keyPu);
  if(err!=UCL_OK)
    {
      PRINTF("ERROR PKCS1 -N6-MSG6: %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.5-SHA256 OK\n");
  keyPu.public_exponent_length=3;
  for(i=0;i<(int)keyPu.public_exponent_length;i++)
    keyPu.public_exponent[i]=e7[i];
  //pkcs ssa pkcs1.5

  ucl_sha256(hash,msg7,128);
  err=ucl_pkcs1_ssa_pkcs1v15_verify (s7, hash,UCL_SHA256_HASHSIZE, &keyPu);
  if(err!=UCL_OK)
    {
      PRINTF("ERROR PKCS1 -N7-MSG7: %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.6-SHA256 OK\n");
  err=ucl_pkcs1_ssa_pkcs1v15_sha256_verify (s7, msg7, 128, &keyPu);
  if(err!=UCL_OK)
    {
      PRINTF("ERROR PKCS1 -N7-MSG7: %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.6-SHA256 OK\n");
  keyPu.public_exponent_length=1;
  for(i=0;i<(int)keyPu.public_exponent_length;i++)
    keyPu.public_exponent[i]=e8[i];
  //pkcs ssa pkcs1.5

  ucl_sha256(hash,msg8,128);
  err=ucl_pkcs1_ssa_pkcs1v15_verify (s8, hash,UCL_SHA256_HASHSIZE, &keyPu);
  if(err!=UCL_OK)
    {
      PRINTF("ERROR PKCS1 -N8-MSG8: %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.7-SHA256 OK\n");
  err=ucl_pkcs1_ssa_pkcs1v15_sha256_verify (s8, msg8, 128, &keyPu);
  if(err!=UCL_OK)
    {
      PRINTF("ERROR PKCS1 -N8-MSG8: %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.7-SHA256 OK\n");
  keyPu.public_exponent_length=1;
  for(i=0;i<(int)keyPu.public_exponent_length;i++)
    keyPu.public_exponent[i]=e8[i];
  //pkcs ssa pkcs1.5
  msg8[0]=msg8[0]+1;

  ucl_sha256(hash,msg8,128);
  err=ucl_pkcs1_ssa_pkcs1v15_verify (s8, hash,UCL_SHA256_HASHSIZE, &keyPu);
  if(err==UCL_OK)
    {
      PRINTF("ERROR PKCS1 -modified-N8-MSG8: SHALL FAIL %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.8-SHA256 OK (FAILED AS EXPECTED)\n");
  err=ucl_pkcs1_ssa_pkcs1v15_sha256_verify (s8, msg8, 128, &keyPu);
  if(err==UCL_OK)
    {
      PRINTF("ERROR PKCS1 -modified-N8-MSG8: SHALL FAIL %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.8-SHA256 OK (FAILED AS EXPECTED)\n");
  keyPu.public_exponent_length=1;
  for(i=0;i<(int)keyPu.public_exponent_length;i++)
    keyPu.public_exponent[i]=e9[i];
  //pkcs ssa pkcs1.5

  ucl_sha1(hash,msg9,128);
  err=ucl_pkcs1_ssa_pkcs1v15_verify (s9, hash,UCL_SHA1_HASHSIZE, &keyPu);
  if(err==UCL_OK)
    {
      PRINTF("ERROR PKCS1 -N9-MSG9: SHALL FAIL %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.9-SHA1 OK (FAILED AS EXPECTED)\n");
  err=ucl_pkcs1_ssa_pkcs1v15_sha1_verify (s9, msg9, 128, &keyPu);
  if(err==UCL_OK)
    {
      PRINTF("ERROR PKCS1 -N9-MSG9: SHALL FAIL %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.9-SHA1 OK (FAILED AS EXPECTED)\n");
  keyPu.public_exponent_length=1;
  for(i=0;i<(int)keyPu.public_exponent_length;i++)
    keyPu.public_exponent[i]=e10[i];
  //pkcs ssa pkcs1.5
  err=ucl_pkcs1_ssa_pkcs1v15_sha1_verify (s10, msg10, 128, &keyPu);
  if(err==UCL_OK)
    {
      PRINTF("ERROR PKCS1 -N10-MSG10: SHALL FAIL %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.10-SHA1 OK (FAILED AS EXPECTED)\n");
  keyPu.public_exponent_length=3;
  for(i=0;i<(int)keyPu.public_exponent_length;i++)
    keyPu.public_exponent[i]=e11[i];
  //pkcs ssa pkcs1.5
  err=ucl_pkcs1_ssa_pkcs1v15_sha1_verify (s11, msg11, 128, &keyPu);
  if(err==UCL_OK)
    {
      PRINTF("ERROR PKCS1 -N11-MSG11: SHALL FAIL %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.11-SHA1 OK (FAILED AS EXPECTED)\n");
  keyPu.public_exponent_length=3;
  for(i=0;i<(int)keyPu.public_exponent_length;i++)
    keyPu.public_exponent[i]=e12[i];
  //pkcs ssa pkcs1.5
  err=ucl_pkcs1_ssa_pkcs1v15_sha256_verify (s12, msg12, 128, &keyPu);
  if(err==UCL_OK)
    {
      PRINTF("ERROR PKCS1 -modified-N12-MSG12: SHALL FAIL %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.12-SHA256 OK (FAILED AS EXPECTED)\n");
  keyPu.public_exponent_length=1;
  for(i=0;i<(int)keyPu.public_exponent_length;i++)
    keyPu.public_exponent[i]=e13[i];
  //pkcs ssa pkcs1.5
  err=ucl_pkcs1_ssa_pkcs1v15_sha256_verify (s13, msg13, 128, &keyPu);
  if(err==UCL_OK)
    {
      PRINTF("ERROR PKCS1 -modified-N13-MSG13: SHALL FAIL %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.13-SHA256 OK (FAILED AS EXPECTED)\n");
  keyPu.public_exponent_length=1;
  for(i=0;i<(int)keyPu.public_exponent_length;i++)
    keyPu.public_exponent[i]=e14[i];
  //pkcs ssa pkcs1.5
  err=ucl_pkcs1_ssa_pkcs1v15_sha256_verify (s14, msg14, 128, &keyPu);
  if(err==UCL_OK)
    {
      PRINTF("ERROR PKCS1 -modified-N14-MSG14: SHALL FAIL %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.14-SHA256 OK (FAILED AS EXPECTED)\n");
  //PKCS-1 creation
  keyPr.modulus_length=128;
  keyPr.modulus=n_pkcs1;
  keyPr.private_exponent=d_pkcs1;

  keyPu.modulus_length=128;
  for(i=0;i<128;i++)
    keyPu.modulus[i]=n_pkcs1[i];
  keyPu.public_exponent_length=1;
  for(i=0;i<(int)keyPu.public_exponent_length;i++)
    keyPu.public_exponent[i]=e_pkcs1[i];
  //pkcs ssa pkcs1.5
  err=ucl_pkcs1_ssa_pkcs1v15_sha1_sign(resu, msg_pkcs1, 128, &keyPr);
  if(err!=UCL_OK)
    {
      PRINTF("PKCS1 SIGN ERROR\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.SHA1 sign OK\n");
  err=ucl_pkcs1_ssa_pkcs1v15_sha1_verify(resu,msg_pkcs1,128, &keyPu);
  if(err!=UCL_OK)
    {
      PRINTF("PKCS1 SHA1 MSG failed err=%d\n ",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("SSA.V15.SHA1 verify OK\n");
  PRINTF("SSA/EMSA/PKCS1/PSS.SHA1/SHA256 OK\n");
  return(UCL_OK);
}

int test_pkcs1_random(void)
{
#define IDF_SHA1 0
#define IDF_SHA256 1
#define IDF_SHA224 2
#define IDF_SHA384 3
#define IDF_SHA512 4
#define IDF_MD5 5
  int maxloop=2;
  u8 resu[128];
  ucl_rsa_public_key_t keyPu;
  ucl_rsa_private_key_t keyPr;
  u8 datakey[128];
  u8 putative_datakey[128];
  u32 putative_len;
  int iloop,ilen,ihash,hashsize;
  int err;

  keyPr.modulus_length=128;
  keyPr.modulus=n_pkcs1;
  keyPr.private_exponent=d_pkcs1;

  PRINTF("ES.OAEP(random msg) for every hash function\n");
  for(iloop=0;iloop<maxloop;iloop++)
    {
      PRINTF("-%d/%d ",iloop+1,maxloop);
      //generate a random message
      ucl_rng_read(datakey,sizeof(datakey),UCL_RAND_DEFAULT);
      //for each hash function
      for(ihash=IDF_SHA1;ihash<=IDF_SHA512;ihash++)
	{
	  //determine the maximum size for the input message
	  //which depends on the hash digest size and the rsa keylength
	  if(ihash==IDF_SHA1)
	    hashsize=UCL_SHA1_HASHSIZE;
	  else
	    if(ihash==IDF_SHA224)
	    hashsize=UCL_SHA224_HASHSIZE;
	  else
	    if(ihash==IDF_MD5)
	    hashsize=UCL_MD5_HASHSIZE;
	  else
	    if(ihash==IDF_SHA384)
	      hashsize=UCL_SHA384_HASHSIZE;
	    else
	      if(ihash==IDF_SHA512)
		hashsize=UCL_SHA512_HASHSIZE;
	      else
		if(ihash==IDF_SHA256)
		  hashsize=UCL_SHA256_HASHSIZE;
	  //for message size from 1 (size=0 is non sense) to maximum size
	  for(ilen=1;ilen<(int)keyPu.modulus_length - (2*hashsize + 2);ilen++)
	    {
	      //perform message encryption
	      if(ihash==IDF_SHA1)
		err=ucl_pkcs1_es_oaep_sha1_encrypt(resu,datakey,ilen, &keyPu,NULL,0);
	      else if(ihash==IDF_SHA256)
		err=ucl_pkcs1_es_oaep_sha256_encrypt(resu,datakey,ilen, &keyPu,NULL,0);
	      else if(ihash==IDF_SHA224)
		err=ucl_pkcs1_es_oaep_sha224_encrypt(resu,datakey,ilen, &keyPu,NULL,0);
	      else if(ihash==IDF_MD5)
		err=ucl_pkcs1_es_oaep_md5_encrypt(resu,datakey,ilen, &keyPu,NULL,0);
	      else if(ihash==IDF_SHA384)
		err=ucl_pkcs1_es_oaep_sha384_encrypt(resu,datakey,ilen, &keyPu,NULL,0);
	      else if(ihash==IDF_SHA512)
		err=ucl_pkcs1_es_oaep_sha512_encrypt(resu,datakey,ilen, &keyPu,NULL,0);
	      if(err!=UCL_OK)
		{
		  PRINTF("PKCS1 ES-OAEP-");
		  if(ihash==IDF_SHA1)
		    PRINTF("SHA1 ");
		  if(ihash==IDF_SHA224)
		    PRINTF("SHA224 ");
		  if(ihash==IDF_MD5)
		    PRINTF("MD5 ");
		  if(ihash==IDF_SHA384)
		    PRINTF("SHA384 ");
		  if(ihash==IDF_SHA512)
		    PRINTF("SHA512 ");
		  if(ihash==IDF_SHA256)
		    PRINTF("SHA256 ");
		  PRINTF("MSG ENC failed err=%d\n ",err);
		  return(UCL_ERROR);
		}
	      if(ihash==IDF_SHA1)
		err=ucl_pkcs1_es_oaep_sha1_decrypt(putative_datakey,&putative_len,resu, &keyPr,NULL,0);
	      else if(ihash==IDF_SHA256)
		err=ucl_pkcs1_es_oaep_sha256_decrypt(putative_datakey,&putative_len,resu, &keyPr,NULL,0);
	      else if(ihash==IDF_SHA224)
		err=ucl_pkcs1_es_oaep_sha224_decrypt(putative_datakey,&putative_len,resu, &keyPr,NULL,0);
	      else if(ihash==IDF_MD5)
		err=ucl_pkcs1_es_oaep_md5_decrypt(putative_datakey,&putative_len,resu, &keyPr,NULL,0);
	      else if(ihash==IDF_SHA384)
		err=ucl_pkcs1_es_oaep_sha384_decrypt(putative_datakey,&putative_len,resu, &keyPr,NULL,0);
	      else if(ihash==IDF_SHA512)
		err=ucl_pkcs1_es_oaep_sha512_decrypt(putative_datakey,&putative_len,resu, &keyPr,NULL,0);
	      if(err!=UCL_OK)
		{
		  PRINTF("ERROR PKCS1 ES-OAEP-");
		  if(ihash==IDF_SHA1)
		    PRINTF("SHA1 ");
		  if(ihash==IDF_SHA224)
		    PRINTF("SHA224 ");
		  if(ihash==IDF_MD5)
		    PRINTF("MD5 ");
		  if(ihash==IDF_SHA384)
		    PRINTF("SHA384 ");
		  if(ihash==IDF_SHA512)
		    PRINTF("SHA512 ");
		  if(ihash==IDF_SHA256)
		    PRINTF("SHA256 ");
		  PRINTF("MSG DEC failed err=%d ",err);
		  return(UCL_ERROR);
		}
	      if(putative_len!=(u32)ilen)
		{
		  PRINTF("PKCS1 ES-OAEP-");
		  if(ihash==IDF_SHA1)
		    PRINTF("SHA1 ");
		  if(ihash==IDF_SHA224)
		    PRINTF("SHA224 ");
		  if(ihash==IDF_MD5)
		    PRINTF("MD5 ");
		  if(ihash==IDF_SHA384)
		    PRINTF("SHA384 ");
		  if(ihash==IDF_SHA512)
		    PRINTF("SHA512 ");
		  if(ihash==IDF_SHA256)
		    PRINTF("SHA256 ");
		  PRINTF(" MSG DEC len failed err=%d (%d, %d)\n ",err,putative_len,ilen);
		  return(UCL_ERROR);
		}
	      if (memcmp(putative_datakey,datakey,ilen) != 0)
		{
		  PRINTF("PKCS1 ES-OAEP-");
		  if(ihash==IDF_SHA1)
		    PRINTF("SHA1 ");
		  if(ihash==IDF_SHA224)
		    PRINTF("SHA224 ");
		  if(ihash==IDF_MD5)
		    PRINTF("MD5 ");
		  if(ihash==IDF_SHA384)
		    PRINTF("SHA384 ");
		  if(ihash==IDF_SHA512)
		    PRINTF("SHA512 ");
		  if(ihash==IDF_SHA256)
		    PRINTF("SHA256 ");
		  PRINTF(" MSG DEC datakey failed err=%d\n ",err);
		  return(UCL_ERROR);
		}
	    }
	}
    }
  PRINTF("ES.OAEP.SHA1/SHA224/SHA256/SHA384/SHA512 OK\n");
  PRINTF("ES.V15(random msg)\n");
  for(iloop=0;iloop<maxloop;iloop++)
    {
      PRINTF("-%d/%d",iloop+1,maxloop);
      //generate a random message
      ucl_rng_read(datakey,sizeof(datakey),UCL_RAND_NO_NULL);
      //for message size from 1 (size=0 is non sense) to maximum size=modulus -11, in bytes
      for(ilen=1;ilen<(int)keyPu.modulus_length -11;ilen++)
	{
	  //perform message encryption
	  err=ucl_pkcs1_es_pkcs1v15_encrypt(resu,datakey,ilen, &keyPu);
	  if(err!=UCL_OK)
	    {
	      PRINTF("PKCS1 ES-PKCS1V15-");
	      PRINTF("MSG ENC failed err=%d\n ",err);
	      return(UCL_ERROR);
	    }
	  putative_len=ilen;
	  err=ucl_pkcs1_es_pkcs1v15_decrypt(putative_datakey,&putative_len,resu, &keyPr);
	  if(err!=UCL_OK)
	    {
	      PRINTF("ERROR PKCS1 ES-PKCS1V15-");
	      PRINTF("MSG DEC failed err=%d ",err);
	      return(UCL_ERROR);
	    }
	  if(putative_len!=(u32)ilen)
	    {
	      PRINTF("PKCS1 ES-PKCS1V15-");
	      PRINTF(" MSG DEC len failed err=%d (%d, %d)\n ",err,putative_len,ilen);
	      return(UCL_ERROR);
	    }
	  if (memcmp(putative_datakey,datakey,ilen) != 0)
	    {
	      PRINTF("PKCS1 ES-PKCS1V15-");
	      PRINTF(" MSG DEC datakey failed err=%d\n ",err);
	      return(UCL_ERROR);
	    }
	}
    }
  PRINTF("ES.PKCS1V15. OK\n");
  err=ucl_pkcs1_ssa_pkcs1v15_sha256_sign(resu, msg_pkcs1, 128, &keyPr);
  if(UCL_OK!=err)
    {
      PRINTF("PKCS1 SIGN ERROR %d\n",err);
      return(UCL_ERROR);
    }
  else
    PRINTF("PKCS1-V15 SHA256 sign OK\n");
  //PKCS-1 creation
  return(UCL_OK);
}



int test_keygeneration_pkcs1_sha(int maxloop,int sha)
{
  u8 output[512];

  u8 msg[512];
  u8 *p,*q;
  u8 *d;
  ucl_rsa_public_key_t keyPu;
  ucl_rsa_private_key_t keyPr;

  u8 e_pubexp[]={0x00,0x01, 0x00,0x01 };
  int imsg;
  int msgmax=2;
  int err;
  int miniloop;
  unsigned int thesize;
  unsigned int thesizemax;
  unsigned int i;
  int resu;

  char hash_name[MAX_HASH_FUNCTIONS][20];

  int salt_len;
  u8 n[512];
  u8 digest[UCL_SHA512_HASHSIZE];
  //thesize=64;//2048bits
  //thesize=96; //3072 bits
  thesizemax=128;
  if(UCL_SHA512!=sha && UCL_SHA224!=sha && UCL_MD5!=sha && UCL_SHA384!=sha && UCL_SHA256!=sha)
    return(UCL_INVALID_INPUT);

 sprintf(hash_name[UCL_SHA1],"sha1");
 sprintf(hash_name[UCL_SHA224],"sha224");
 sprintf(hash_name[UCL_SHA256],"sha256");
 sprintf(hash_name[UCL_SHA384],"sha384");
 sprintf(hash_name[UCL_SHA512],"sha512");
 sprintf(hash_name[UCL_MD5],"md5");

  for(i=0;i<thesizemax;i++)
    msg[i]=0;
  //as recommended in PKCS#1 PSS, p34 note 4
  salt_len=UCL_SHA256_HASHSIZE;

  PRINTF("salt len=%d\n",salt_len);
  for(thesize=128;thesize<=thesizemax;thesize+=32)
    {
      PRINTF("\nRSA-%d keygen (%d gen., %d verif./gen.)\n",thesize*32,maxloop,msgmax);
      if (ucl_stack_alloc((u32**)&p,  thesizemax/2) != UCL_OK)
	    return UCL_STACK_ERROR;
      if (ucl_stack_alloc((u32**) &q,  thesizemax/2) != UCL_OK)
	    return UCL_STACK_ERROR;
      if (ucl_stack_alloc((u32**)&d,  thesizemax) != UCL_OK)
	    return UCL_STACK_ERROR;
      for(miniloop=0;miniloop<maxloop;miniloop++)
	{
	    PRINTF(".%d",miniloop);
	  // generate rsa keypair, with F4=65537
	  err=ucl_rsa_param_generation(n,p,q,d,e_pubexp,4,thesize*4);
	  if(err!=UCL_OK)
	    {
	      PRINTF("ERROR RSA %d %d GEN\n",err,thesize*32);
	      resu=UCL_ERROR;
	      goto endofroutine;
	    }
	  else
	    PRINTF(" generated ");

	  //PKCS-1 creation
	  keyPr.modulus_length=thesize*4;
	  keyPu.modulus_length=thesize*4;
	  keyPu.public_exponent_length=4;

	  for(i=0;i<thesize*4;i++)
	    {
	      keyPu.modulus[i]=n[i];
	    }
	  keyPr.modulus=n;
	  keyPr.private_exponent=d;
	  for(i=0;i<keyPu.public_exponent_length;i++)
	    keyPu.public_exponent[i]=e_pubexp[i];

	  //generate msgmax messages
	  //and test sign-verify cycle with the generated RSA key
	  //PKCS#1 PSS
	  for(imsg=0;imsg<msgmax;imsg++)
	    {
	      ucl_rng_read((u8*)msg,thesize*4,UCL_RAND_DEFAULT);
	      msg[thesize-1]=0;
	      PRINTF("signature\n");
	      if(UCL_SHA512==sha)
		err=ucl_pkcs1_ssa_pss_sha512_sign(output, (u8*)msg, thesize*4, &keyPr,salt_len);
	      else
		if(UCL_SHA256==sha)
		  err=ucl_pkcs1_ssa_pss_sha256_sign(output, (u8*)msg, thesize*4, &keyPr,salt_len);
	      if(err!=UCL_OK)
		{
		  PRINTF("PKCS1 PSS SIGN ERROR\n");
		  return(UCL_ERROR);
		}
	      if(UCL_SHA512==sha)
		err=ucl_pkcs1_ssa_pss_sha512_verify(output,(u8*)msg,thesize*4, &keyPu,salt_len);
	      else
		if(UCL_SHA256==sha)
		  err=ucl_pkcs1_ssa_pss_sha256_verify(output,(u8*)msg,thesize*4, &keyPu,salt_len);
	      if(err!=UCL_OK)
		{
		  PRINTF("PKCS1 %s PSS MSG fled err=%d\n ",hash_name[sha],err);
		  return(UCL_ERROR);
		}
	      else
		PRINTF("SSA.PSS.%s sign-verify OK\n",hash_name[sha]);
	      //pre-hashed data
	      PRINTF("pre-hashed signature\n");
	      if(UCL_SHA512==sha)
		{
		  ucl_sha512(digest,msg,thesize*4);
		  err=ucl_pkcs1_ssa_pss_sha512_hashed_sign(output, (u8*)digest, UCL_SHA512_HASHSIZE, &keyPr,salt_len);
		}
	      else
		if(UCL_SHA256==sha)
		  err=ucl_pkcs1_ssa_pss_sha256_sign(output, (u8*)msg, thesize*4, &keyPr,salt_len);
	      if(err!=UCL_OK)
		{
		  PRINTF("PKCS1 PSS SIGN ERROR\n");
		  return(UCL_ERROR);
		}
	      if(UCL_SHA512==sha)
		err=ucl_pkcs1_ssa_pss_sha512_verify(output,(u8*)msg,thesize*4, &keyPu,salt_len);
	      else
		if(UCL_SHA256==sha)
		  err=ucl_pkcs1_ssa_pss_sha256_verify(output,(u8*)msg,thesize*4, &keyPu,salt_len);
	      if(err!=UCL_OK)
		{
		  PRINTF("PKCS1 %s PSS MSG failed err=%d\n ",hash_name[sha],err);
		  return(UCL_ERROR);
		}
	      else
		PRINTF("SSA.PSS.%s sign-verify OK\n",hash_name[sha]);
	    }
	  PRINTF("checked\n");
	}
      if (ucl_stack_free((u32**)&d) != UCL_OK)
	{
	  PRINTF("error stack d\n");
	return UCL_STACK_ERROR;
	}
      if (ucl_stack_free((u32**)&q) != UCL_OK)
	{
	  PRINTF("error stack q\n");
	return UCL_STACK_ERROR;
	}
      if (ucl_stack_free((u32**)&p) != UCL_OK)
	{
	  PRINTF("error stack p\n");
	return UCL_STACK_ERROR;
	}
    }
  resu=UCL_OK;
 endofroutine:
PRINTF("\n");
 return(resu);
}

int test_keygeneration_pkcs1_sha256(int maxloop)
{
  return(test_keygeneration_pkcs1_sha(maxloop,UCL_SHA256));
}

int test_keygeneration_pkcs1_sha224(int maxloop)
{
  return(test_keygeneration_pkcs1_sha(maxloop,UCL_SHA224));
}

int test_keygeneration_pkcs1_md5(int maxloop)
{
  return(test_keygeneration_pkcs1_sha(maxloop,UCL_MD5));
}

int test_keygeneration_pkcs1_sha384(int maxloop)
{
  return(test_keygeneration_pkcs1_sha(maxloop,UCL_SHA384));
}

int test_keygeneration_pkcs1_sha512(int maxloop)
{
  return(test_keygeneration_pkcs1_sha(maxloop,UCL_SHA512));
}



//FIPS186-4 generation method is restricted to 1024, 2048, 3072 and 4096-bit keys 
int test_keygeneration_pkcs1_sha_fips186_4(int maxloop,int sha)
{
  u8 *p,*q;
  u8 *d;
  ucl_rsa_public_key_t keyPu;
  ucl_rsa_private_key_t keyPr;

  u8 msg[512];
  u8 e_pubexp[]={0x00,0x01, 0x00,0x01 };
  int imsg;
  int msgmax=1;
  int err;
  int miniloop;
  unsigned int thesize;
  unsigned int thesizemax;
  unsigned int i;
  int resu;
  u8 output[512];

  char hash_name[MAX_HASH_FUNCTIONS][20];

  int salt_len;
  u8 n[512];

  if(UCL_SHA512!=sha && UCL_SHA224!=sha && UCL_MD5!=sha && UCL_SHA384!=sha && UCL_SHA256!=sha)
    return(UCL_INVALID_INPUT);

 sprintf(hash_name[UCL_SHA1],"sha1");
 sprintf(hash_name[UCL_SHA224],"sha224");
 sprintf(hash_name[UCL_SHA256],"sha256");
 sprintf(hash_name[UCL_SHA384],"sha384");
 sprintf(hash_name[UCL_SHA512],"sha512");
 sprintf(hash_name[UCL_MD5],"md5");

  //thesize=64;//2048bits
  //thesize=96; //3072 bits
 //thesize=128;//4096 bits
  thesizemax=128;
  PRINTF("*** FIPS 186-4 generation method is restricted to 1024, 2048, 3072 and 4096-bit keys \n");
  for(i=0;i<thesizemax;i++)
    msg[i]=0;
  //as recommended in PKCS#1 PSS, p34 note 4
  salt_len=UCL_SHA256_HASHSIZE;
  PRINTF("salt len=%d\n",salt_len);
  for(thesize=64;thesize<=thesizemax;thesize+=32)
    if(thesize==32 || thesize==64 || thesize==96 ||thesize==128)
    {
      PRINTF("RSA-%d keygen FIPS186-4 (%d gen., %d verif./gen.)\n",thesize*32,maxloop,msgmax);
      if (ucl_stack_alloc((u32**)&p,  thesizemax/2) != UCL_OK)
	    return UCL_STACK_ERROR;
      if (ucl_stack_alloc((u32**) &q,  thesizemax/2) != UCL_OK)
	    return UCL_STACK_ERROR;
      if (ucl_stack_alloc((u32**)&d,  thesizemax) != UCL_OK)
	    return UCL_STACK_ERROR;
      for(miniloop=0;miniloop<maxloop;miniloop++)
	{
	  // generate rsa keypair, with F4=65537
	  err=ucl_rsa_param_generation_fips186_4(n,p,q,d,e_pubexp,4,thesize*4);
	  if(err!=UCL_OK)
	    {
	      PRINTF("ERROR RSA %d %d GEN\n",err,thesize*32);
	      resu=UCL_ERROR;
	      goto endofroutine;
	    }
	  else
	    PRINTF(" generated ");
	  //PKCS-1 creation
	  keyPr.modulus_length=thesize*4;
	  keyPu.modulus_length=thesize*4;
	  keyPu.public_exponent_length=4;

	  for(i=0;i<thesize*4;i++)
	    {
	      keyPu.modulus[i]=n[i];
	    }
	  keyPr.modulus=n;
	  keyPr.private_exponent=d;
	  for(i=0;i<keyPu.public_exponent_length;i++)
	    keyPu.public_exponent[i]=e_pubexp[i];

	  //generate msgmax messages
	  //and test sign-verify cycle with the generated RSA key
	  //PKCS#1 PSS
	  for(imsg=0;imsg<msgmax;imsg++)
	    {
	      ucl_rng_read((u8*)msg,thesize*4,UCL_RAND_DEFAULT);
	      msg[thesize-1]=0;
	      if(UCL_SHA512==sha)
		err=ucl_pkcs1_ssa_pss_sha512_sign(output, (u8*)msg, thesize*4, &keyPr,salt_len);
	      if(UCL_SHA224==sha)
		err=ucl_pkcs1_ssa_pss_sha224_sign(output, (u8*)msg, thesize*4, &keyPr,salt_len);
	      if(UCL_MD5==sha)
		err=ucl_pkcs1_ssa_pss_md5_sign(output, (u8*)msg, thesize*4, &keyPr,salt_len);
	      if(UCL_SHA384==sha)
		err=ucl_pkcs1_ssa_pss_sha384_sign(output, (u8*)msg, thesize*4, &keyPr,salt_len);
	      if(UCL_SHA256==sha)
		err=ucl_pkcs1_ssa_pss_sha256_sign(output, (u8*)msg, thesize*4, &keyPr,salt_len);
	      if(err!=UCL_OK)
		{
		  PRINTF("PKCS1 PSS SIGN ERROR\n");
		  return(UCL_ERROR);
		}
	      if(UCL_SHA512==sha)
		err=ucl_pkcs1_ssa_pss_sha512_verify(output,(u8*)msg,thesize*4, &keyPu,salt_len);
	      if(UCL_SHA224==sha)
		err=ucl_pkcs1_ssa_pss_sha224_verify(output,(u8*)msg,thesize*4, &keyPu,salt_len);
	      if(UCL_MD5==sha)
		err=ucl_pkcs1_ssa_pss_md5_verify(output,(u8*)msg,thesize*4, &keyPu,salt_len);
	      if(UCL_SHA384==sha)
		err=ucl_pkcs1_ssa_pss_sha384_verify(output,(u8*)msg,thesize*4, &keyPu,salt_len);
	      if(UCL_SHA256==sha)
		err=ucl_pkcs1_ssa_pss_sha256_verify(output,(u8*)msg,thesize*4, &keyPu,salt_len);
	      if(err!=UCL_OK)
		{
		  PRINTF("PKCS1 %s PSS MSG failed err=%d\n ",hash_name[sha],err);
		  return(UCL_ERROR);
		}
	      else
		PRINTF("SSA.PSS.%s sign-verify OK\n",hash_name[sha]);
	    }
	}
      if (ucl_stack_free((u32**)&d) != UCL_OK)
	return UCL_STACK_ERROR;
      if (ucl_stack_free((u32**)&q) != UCL_OK)
	return UCL_STACK_ERROR;
      if (ucl_stack_free((u32**)&p) != UCL_OK)
	return UCL_STACK_ERROR;
    }
  resu=UCL_OK;
 endofroutine:
PRINTF("\n");
 return(resu);
}

int test_keygeneration_pkcs1_sha256_fips186_4(int maxloop)
{
  return(test_keygeneration_pkcs1_sha_fips186_4(maxloop,UCL_SHA256));
}

int test_keygeneration_pkcs1_sha224_fips186_4(int maxloop)
{
  return(test_keygeneration_pkcs1_sha_fips186_4(maxloop,UCL_SHA224));
}

int test_keygeneration_pkcs1_md5_fips186_4(int maxloop)
{
  return(test_keygeneration_pkcs1_sha_fips186_4(maxloop,UCL_MD5));
}

int test_keygeneration_pkcs1_sha384_fips186_4(int maxloop)
{
  return(test_keygeneration_pkcs1_sha_fips186_4(maxloop,UCL_SHA384));
}

int test_keygeneration_pkcs1_sha512_fips186_4(int maxloop)
{
  return(test_keygeneration_pkcs1_sha_fips186_4(maxloop,UCL_SHA512));
}

int test_keygeneration_pkcs1_fips186_4_B36_RSA2VS(int maxloop)
{
  ucl_rsa_public_key_t keyPu;
  ucl_rsa_private_key_t keyPr;

  u8 msg[UCL_RSA_KEY_MAXSIZE];
  u8 e_pubexp[]={0x00,0x01, 0x00,0x01 };
  int imsg;
  int msgmax=1;
  int err;
  int miniloop;
  unsigned int thesizemax;
  unsigned int thesize;
  unsigned int i;
  int resu;
  u8 output[UCL_RSA_KEY_MAXSIZE];

  int salt_len;
  int bitlen1,bitlen2;
  u8 n[UCL_RSA_KEY_MAXSIZE];
  u8 p[UCL_RSA_KEY_MAXSIZE/2];
  u8 q[UCL_RSA_KEY_MAXSIZE/2];
  u8 d[UCL_RSA_KEY_MAXSIZE];
  u8 xp[UCL_RSA_KEY_MAXSIZE/2];
  u8 xq[UCL_RSA_KEY_MAXSIZE/2];
  u8 xp1[UCL_RSA_KEY_MAXSIZE/2];
  u8 xp2[UCL_RSA_KEY_MAXSIZE/2];
  u8 xq1[UCL_RSA_KEY_MAXSIZE/2];
  u8 xq2[UCL_RSA_KEY_MAXSIZE/2];
  u8 p1[UCL_RSA_KEY_MAXSIZE/2];
  u8 p2[UCL_RSA_KEY_MAXSIZE/2];
  u8 q1[UCL_RSA_KEY_MAXSIZE/2];
  u8 q2[UCL_RSA_KEY_MAXSIZE/2];

  //thesize=64;//2048bits
  //thesize=96; //3072 bits
  thesizemax=64;//b36 limited to 3072 bits

  PRINTF("*** FIPS 186-4 generation method is restricted to 1024-,2048-, 3072- and 4096-bit keys \n");
  for(i=0;i<thesizemax;i++)
    msg[i]=0;
  //as recommended in PKCS#1 PSS, p34 note 4
  salt_len=UCL_SHA256_HASHSIZE;
  PRINTF("salt len=%d\n",salt_len);
  for(thesize=32;thesize<=thesizemax;thesize+=32)
    {
      PRINTF("RSA-%d keygen  FIPS186-4 B36 RSA2VS (%d gen., %d verif./gen.)\n",thesize*32,maxloop,msgmax);

      for(miniloop=0;miniloop<maxloop;miniloop++)
	{
	  // generate rsa keypair, with F4=65537
	  err=ucl_rsa_param_generation_fips186_4_B36_RSA2VS(n,p,q,d,xp1,xp2,p1,p2,xp,xq1,xq2,q1,q2,xq,&bitlen1,&bitlen2,e_pubexp,4,thesize*4);
	  if(err!=UCL_OK)
	    {
	      PRINTF("ERROR RSA %d %d GEN\n",err,thesize*32);
	      resu=UCL_ERROR;
	      goto endofroutine;
	    }
	  else
	    PRINTF(" generated ");
	  //PKCS-1 creation
	  keyPr.modulus_length=thesize*4;
	  keyPu.modulus_length=thesize*4;
	  keyPu.public_exponent_length=4;
	  
	  for(i=0;i<thesize*4;i++)
	    {
	      keyPu.modulus[i]=n[i];
	    }
	  keyPr.modulus=n;
	  keyPr.private_exponent=d;
	  for(i=0;i<keyPu.public_exponent_length;i++)
	    keyPu.public_exponent[i]=e_pubexp[i];
	  
	  //generate msgmax messages
	  //and test sign-verify cycle with the generated RSA key
	  //PKCS#1 PSS
	  for(imsg=0;imsg<msgmax;imsg++)
	    {
	      ucl_rng_read((u8*)msg,thesize*4,UCL_RAND_DEFAULT);
	      msg[thesize-1]=0;
	      err=ucl_pkcs1_ssa_pss_sha256_sign(output, (u8*)msg, thesize*4, &keyPr,salt_len);
	      if(err!=UCL_OK)
		{
		  PRINTF("PKCS1 PSS SIGN ERROR\n");
		  return(UCL_ERROR);
		}
	      err=ucl_pkcs1_ssa_pss_sha256_verify(output,(u8*)msg,thesize*4, &keyPu,salt_len);
	      if(err!=UCL_OK)
		{
		  PRINTF("PKCS1 SHA256 PSS MSG failed err=%d\n ",err);
		  return(UCL_ERROR);
		}
	      else
		PRINTF("SSA.PSS.SHA256 sign-verify OK\n");
	    }
	}
    }
  resu=UCL_OK;
 endofroutine:
 return(resu);
}

int test_pkcs1(int maxvalue)
{
  int ret;
  ret=UCL_OK;
  PRINTF("PKCS1 (%d)\n",maxvalue);
  if(UCL_OK!=test_keygeneration_pkcs1_sha224(maxvalue))
    {
      PRINTF("ERROR keygen-pkcs1-sha224\n");
      ret=UCL_ERROR;
    }
  else
  PRINTF("PKCS1 SHA224 KG OK\n");
  if(UCL_OK!=test_keygeneration_pkcs1_md5(maxvalue))
    {
      PRINTF("ERROR keygen-pkcs1-md5\n");
      ret=UCL_ERROR;
    }
  else
  PRINTF("PKCS1 MD5 KG OK\n");
  if(UCL_OK!=test_keygeneration_pkcs1_sha256(maxvalue))
    {
    PRINTF("ERROR keygen-pkcs1-sha256\n");
      ret=UCL_ERROR;
    }
  else
    PRINTF("PKCS1 SHA256 KG OK\n");
  if(UCL_OK!=test_keygeneration_pkcs1_sha384(maxvalue))
    {
    PRINTF("ERROR keygen-pkcs1-sha384\n");
      ret=UCL_ERROR;
    }
  else
  PRINTF("PKCS1 SHA384 KG OK\n");
  if(UCL_OK!=test_keygeneration_pkcs1_sha512(maxvalue))
    {
    PRINTF("ERROR keygen-pkcs1-sha512\n");
      ret=UCL_ERROR;
    }
  else
  PRINTF("PKCS1 SHA512 KG OK\n");

  if(UCL_OK!=test_keygeneration_pkcs1_sha224_fips186_4(maxvalue))
    {
    PRINTF("ERROR keygen-pkcs1-sha224-fips186-4\n");
      ret=UCL_ERROR;
    }
  else
    PRINTF("PKCS1 SHA224 KG FIPS186-4 OK\n");
  if(UCL_OK!=test_keygeneration_pkcs1_md5_fips186_4(maxvalue))
    {
    PRINTF("ERROR keygen-pkcs1-md5-fips186-4\n");
      ret=UCL_ERROR;
    }
  else
    PRINTF("PKCS1 MD5 KG FIPS186-4 OK\n");
  if(UCL_OK!=test_keygeneration_pkcs1_sha256_fips186_4(maxvalue))
    {
    PRINTF("ERROR keygen-pkcs1-sha256-fips186-4\n");
      ret=UCL_ERROR;
    }
  else
    PRINTF("PKCS1 SHA256 KG FIPS186-4 OK\n");
  if(UCL_OK!=test_keygeneration_pkcs1_sha384_fips186_4(maxvalue))
    {
    PRINTF("ERROR keygen-pkcs1-sha384-fips186-4\n");
      ret=UCL_ERROR;
    }
  else
    PRINTF("PKCS1 SHA384 KG FIPS186-4 OK\n");
  if(UCL_OK!=test_keygeneration_pkcs1_sha512_fips186_4(maxvalue))
    {
    PRINTF("ERROR keygen-pkcs1-sha512-fips186-4\n");
      ret=UCL_ERROR;
    }
  else
    PRINTF("PKCS1 SHA512 KG FIPS186-4 OK\n");

  if(UCL_OK!=test_keygeneration_pkcs1_fips186_4_B36_RSA2VS(maxvalue))
    {
    PRINTF("ERROR keygen-pkcs1-fips186-4-b36-rsa2vs\n");
      ret=UCL_ERROR;
    }
  else
  PRINTF("PKCS1 KG FIPS186-4 B36 RSA2VS OK\n");
  if(UCL_OK!=test_pkcs1_kat())
    {
    PRINTF("ERROR pkcs1 KAT\n");
      ret=UCL_ERROR;
    }
  else
    PRINTF("PKCS1 KAT OK\n");
  if(UCL_OK!=test_pkcs1_random())
    {
    PRINTF("ERROR pkcs1 RANDOM\n");
      ret=UCL_ERROR;
    }
  else
    PRINTF("PKCS1 RANDOM OK\n");
  return(ret);
}
