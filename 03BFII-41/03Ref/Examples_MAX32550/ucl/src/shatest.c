/*******************************************************************************
 * Copyright (C) 1999-2014 Maxim Integrated Products, All Rights Reserved.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a
 * copy of this software and associated documentation files (the "Software"),
 * to deal in the Software without restriction, including without limitation
 * the rights to use, copy, modify, merge, publish, distribute, sublicense,
 * and/or sell copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included
 * in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
 * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY,  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
 * IN NO EVENT SHALL MAXIM INTEGRATED PRODUCTS BE LIABLE FOR ANY CLAIM, DAMAGES
 * OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
 * ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 *
 * Except as contained in this notice, the name of Maxim Integrated Products
 * shall not be used except as stated in the Maxim Integrated Products
 * Branding Policy.
 *
 * The mere transfer of this software does not imply any licenses
 * of trade secrets, proprietary technology, copyrights, patents,
 * trademarks, maskwork rights, or any other form of intellectual
 * property whatsoever. Maxim Integrated Products retains all ownership rights.
 *
 *     Module Name: SHA test module
 *     Description: performs SHA, HMAC-SHA testing
 *        Filename: shatest.c
 *          Author: LSL
 *        Compiler: gcc
 *
 *******************************************************************************
 */

#ifdef JIBE_LINUX
#include "config.h"
#endif


#include <ucl_testing_config.h>
#ifdef SYSTEM_JIBE
#include <printf_lite.h>
#endif
#ifdef SYSTEM_LIGHTHOUSE
#include <printf_lite.h>
#endif
#include <stdio.h>
#include <string.h>
#include <stdint.h>


#ifndef _TESTCRYPTO_H
#define _TESTCRYPTO_H
#define __API__
#endif // _TESTCRYPTO_H
#include <ucl/ecdsa_generic_api.h>
#include <ecdsatest.h>
#include <ucl/ucl_hash.h>
#include <ucl/ucl_retdefs.h>
#include <ucl/ucl_types.h>
#include <ucl/ucl_stest.h>
#include <ucl/ucl_aes.h>
#include <ucl/ucl_rng.h>
#include <ucl/ucl_trng.h>
#include <ucl/ucl_types.h>
#include <ucl/ucl_config.h>
#include <ucl/ucl_defs.h>
#include <ucl/ucl_sys.h>
#include <ucl/ucl_data_conv.h>
#include <ucl/ucl_stack.h>
#include <ucl/ucl_sha1.h>
#include <ucl/ucl_sha224.h>
#include <ucl/ucl_sha256.h>
#include <ucl/ucl_hmac_sha256.h>
#include <ucl/ucl_sha384.h>
#include <ucl/ucl_sha512.h>
#include <ucl/ucl_sia256.h>
#include <ucl/ucl_sha3.h>
#include <ucl/ucl_sm3.h>


//HMAC RFC 4231 test vectors for HMAC SHA-224, SHA-256, SHA-384 and SHA-512
u8 key_rfc4231_1[]={0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b};
u8 msg_rfc4231_1[]={0x48,0x69,0x20,0x54,0x68,0x65,0x72,0x65};
u8 mac224_rfc4231_1[]={0x89,0x6f,0xb1,0x12,0x8a,0xbb,0xdf,0x19,0x68,0x32,0x10,0x7c,0xd4,0x9d,0xf3,0x3f,0x47,0xb4,0xb1,0x16,0x99,0x12,0xba,0x4f,0x53,0x68,0x4b,0x22};
u8 mac256_rfc4231_1[]={0xb0,0x34,0x4c,0x61,0xd8,0xdb,0x38,0x53,0x5c,0xa8,0xaf,0xce,0xaf,0x0b,0xf1,0x2b,0x88,0x1d,0xc2,0x00,0xc9,0x83,0x3d,0xa7,0x26,0xe9,0x37,0x6c,0x2e,0x32,0xcf,0xf7};
u8 mac384_rfc4231_1[]={0xaf,0xd0,0x39,0x44,0xd8,0x48,0x95,0x62,0x6b,0x08,0x25,0xf4,0xab,0x46,0x90,0x7f,0x15,0xf9,0xda,0xdb,0xe4,0x10,0x1e,0xc6,0x82,0xaa,0x03,0x4c,0x7c,0xeb,0xc5,0x9c,0xfa,0xea,0x9e,0xa9,0x07,0x6e,0xde,0x7f,0x4a,0xf1,0x52,0xe8,0xb2,0xfa,0x9c,0xb6};
u8 mac512_rfc4231_1[]={0x87,0xaa,0x7c,0xde,0xa5,0xef,0x61,0x9d,0x4f,0xf0,0xb4,0x24,0x1a,0x1d,0x6c,0xb0,0x23,0x79,0xf4,0xe2,0xce,0x4e,0xc2,0x78,0x7a,0xd0,0xb3,0x05,0x45,0xe1,0x7c,0xde,0xda,0xa8,0x33,0xb7,0xd6,0xb8,0xa7,0x02,0x03,0x8b,0x27,0x4e,0xae,0xa3,0xf4,0xe4,0xbe,0x9d,0x91,0x4e,0xeb,0x61,0xf1,0x70,0x2e,0x69,0x6c,0x20,0x3a,0x12,0x68,0x54};

u8 key_rfc4231_2[]={0x4a,0x65,0x66,0x65};
u8 msg_rfc4231_2[]={0x77,0x68,0x61,0x74,0x20,0x64,0x6f,0x20,0x79,0x61,0x20,0x77,0x61,0x6e,0x74,0x20,0x66,0x6f,0x72,0x20,0x6e,0x6f,0x74,0x68,0x69,0x6e,0x67,0x3f};

u8 mac224_rfc4231_2[]={0xa3,0x0e,0x01,0x09,0x8b,0xc6,0xdb,0xbf,0x45,0x69,0x0f,0x3a,0x7e,0x9e,0x6d,0x0f,0x8b,0xbe,0xa2,0xa3,0x9e,0x61,0x48,0x00,0x8f,0xd0,0x5e,0x44};
u8 mac256_rfc4231_2[]={0x5b,0xdc,0xc1,0x46,0xbf,0x60,0x75,0x4e,0x6a,0x04,0x24,0x26,0x08,0x95,0x75,0xc7,0x5a,0x00,0x3f,0x08,0x9d,0x27,0x39,0x83,0x9d,0xec,0x58,0xb9,0x64,0xec,0x38,0x43};
u8 mac384_rfc4231_2[]={0xaf,0x45,0xd2,0xe3,0x76,0x48,0x40,0x31,0x61,0x7f,0x78,0xd2,0xb5,0x8a,0x6b,0x1b,0x9c,0x7e,0xf4,0x64,0xf5,0xa0,0x1b,0x47,0xe4,0x2e,0xc3,0x73,0x63,0x22,0x44,0x5e,0x8e,0x22,0x40,0xca,0x5e,0x69,0xe2,0xc7,0x8b,0x32,0x39,0xec,0xfa,0xb2,0x16,0x49};
u8 mac512_rfc4231_2[]={0x16,0x4b,0x7a,0x7b,0xfc,0xf8,0x19,0xe2,0xe3,0x95,0xfb,0xe7,0x3b,0x56,0xe0,0xa3,0x87,0xbd,0x64,0x22,0x2e,0x83,0x1f,0xd6,0x10,0x27,0x0c,0xd7,0xea,0x25,0x05,0x54,0x97,0x58,0xbf,0x75,0xc0,0x5a,0x99,0x4a,0x6d,0x03,0x4f,0x65,0xf8,0xf0,0xe6,0xfd,0xca,0xea,0xb1,0xa3,0x4d,0x4a,0x6b,0x4b,0x63,0x6e,0x07,0x0a,0x38,0xbc,0xe7,0x37};

u8 key_rfc4231_3[]={0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa};
u8 msg_rfc4231_3[]={0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd,0xdd};

u8 mac224_rfc4231_3[]={0x7f,0xb3,0xcb,0x35,0x88,0xc6,0xc1,0xf6,0xff,0xa9,0x69,0x4d,0x7d,0x6a,0xd2,0x64,0x93,0x65,0xb0,0xc1,0xf6,0x5d,0x69,0xd1,0xec,0x83,0x33,0xea};
u8 mac256_rfc4231_3[]={0x77,0x3e,0xa9,0x1e,0x36,0x80,0x0e,0x46,0x85,0x4d,0xb8,0xeb,0xd0,0x91,0x81,0xa7,0x29,0x59,0x09,0x8b,0x3e,0xf8,0xc1,0x22,0xd9,0x63,0x55,0x14,0xce,0xd5,0x65,0xfe};
u8 mac384_rfc4231_3[]={0x88,0x06,0x26,0x08,0xd3,0xe6,0xad,0x8a,0x0a,0xa2,0xac,0xe0,0x14,0xc8,0xa8,0x6f,0x0a,0xa6,0x35,0xd9,0x47,0xac,0x9f,0xeb,0xe8,0x3e,0xf4,0xe5,0x59,0x66,0x14,0x4b,0x2a,0x5a,0xb3,0x9d,0xc1,0x38,0x14,0xb9,0x4e,0x3a,0xb6,0xe1,0x01,0xa3,0x4f,0x27};
u8 mac512_rfc4231_3[]={0xfa,0x73,0xb0,0x08,0x9d,0x56,0xa2,0x84,0xef,0xb0,0xf0,0x75,0x6c,0x89,0x0b,0xe9,0xb1,0xb5,0xdb,0xdd,0x8e,0xe8,0x1a,0x36,0x55,0xf8,0x3e,0x33,0xb2,0x27,0x9d,0x39,0xbf,0x3e,0x84,0x82,0x79,0xa7,0x22,0xc8,0x06,0xb4,0x85,0xa4,0x7e,0x67,0xc8,0x07,0xb9,0x46,0xa3,0x37,0xbe,0xe8,0x94,0x26,0x74,0x27,0x88,0x59,0xe1,0x32,0x92,0xfb};

u8 key_rfc4231_4[]={0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0a,0x0b,0x0c,0x0d,0x0e,0x0f,0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19};
u8 msg_rfc4231_4[]={0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd,0xcd};

u8 mac224_rfc4231_4[]={0x6c,0x11,0x50,0x68,0x74,0x01,0x3c,0xac,0x6a,0x2a,0xbc,0x1b,0xb3,0x82,0x62,0x7c,0xec,0x6a,0x90,0xd8,0x6e,0xfc,0x01,0x2d,0xe7,0xaf,0xec,0x5a,};
u8 mac256_rfc4231_4[]={0x82,0x55,0x8a,0x38,0x9a,0x44,0x3c,0x0e,0xa4,0xcc,0x81,0x98,0x99,0xf2,0x08,0x3a,0x85,0xf0,0xfa,0xa3,0xe5,0x78,0xf8,0x07,0x7a,0x2e,0x3f,0xf4,0x67,0x29,0x66,0x5b};
u8 mac384_rfc4231_4[]={0x3e,0x8a,0x69,0xb7,0x78,0x3c,0x25,0x85,0x19,0x33,0xab,0x62,0x90,0xaf,0x6c,0xa7,0x7a,0x99,0x81,0x48,0x08,0x50,0x00,0x9c,0xc5,0x57,0x7c,0x6e,0x1f,0x57,0x3b,0x4e,0x68,0x01,0xdd,0x23,0xc4,0xa7,0xd6,0x79,0xcc,0xf8,0xa3,0x86,0xc6,0x74,0xcf,0xfb};
u8 mac512_rfc4231_4[]={0xb0,0xba,0x46,0x56,0x37,0x45,0x8c,0x69,0x90,0xe5,0xa8,0xc5,0xf6,0x1d,0x4a,0xf7,0xe5,0x76,0xd9,0x7f,0xf9,0x4b,0x87,0x2d,0xe7,0x6f,0x80,0x50,0x36,0x1e,0xe3,0xdb,0xa9,0x1c,0xa5,0xc1,0x1a,0xa2,0x5e,0xb4,0xd6,0x79,0x27,0x5c,0xc5,0x78,0x80,0x63,0xa5,0xf1,0x97,0x41,0x12,0x0c,0x4f,0x2d,0xe2,0xad,0xeb,0xeb,0x10,0xa2,0x98,0xdd};

u8 key_rfc4231_6[]={0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa};
u8 msg_rfc4231_6[]={0x54,0x65,0x73,0x74,0x20,0x55,0x73,0x69,0x6e,0x67,0x20,0x4c,0x61,0x72,0x67,0x65,0x72,0x20,0x54,0x68,0x61,0x6e,0x20,0x42,0x6c,0x6f,0x63,0x6b,0x2d,0x53,0x69,0x7a,0x65,0x20,0x4b,0x65,0x79,0x20,0x2d,0x20,0x48,0x61,0x73,0x68,0x20,0x4b,0x65,0x79,0x20,0x46,0x69,0x72,0x73,0x74};

u8 mac224_rfc4231_6[]={0x95,0xe9,0xa0,0xdb,0x96,0x20,0x95,0xad,0xae,0xbe,0x9b,0x2d,0x6f,0x0d,0xbc,0xe2,0xd4,0x99,0xf1,0x12,0xf2,0xd2,0xb7,0x27,0x3f,0xa6,0x87,0x0e};
u8 mac256_rfc4231_6[]={0x60,0xe4,0x31,0x59,0x1e,0xe0,0xb6,0x7f,0x0d,0x8a,0x26,0xaa,0xcb,0xf5,0xb7,0x7f,0x8e,0x0b,0xc6,0x21,0x37,0x28,0xc5,0x14,0x05,0x46,0x04,0x0f,0x0e,0xe3,0x7f,0x54};
u8 mac384_rfc4231_6[]={0x4e,0xce,0x08,0x44,0x85,0x81,0x3e,0x90,0x88,0xd2,0xc6,0x3a,0x04,0x1b,0xc5,0xb4,0x4f,0x9e,0xf1,0x01,0x2a,0x2b,0x58,0x8f,0x3c,0xd1,0x1f,0x05,0x03,0x3a,0xc4,0xc6,0x0c,0x2e,0xf6,0xab,0x40,0x30,0xfe,0x82,0x96,0x24,0x8d,0xf1,0x63,0xf4,0x49,0x52};
u8 mac512_rfc4231_6[]={0x80,0xb2,0x42,0x63,0xc7,0xc1,0xa3,0xeb,0xb7,0x14,0x93,0xc1,0xdd,0x7b,0xe8,0xb4,0x9b,0x46,0xd1,0xf4,0x1b,0x4a,0xee,0xc1,0x12,0x1b,0x01,0x37,0x83,0xf8,0xf3,0x52,0x6b,0x56,0xd0,0x37,0xe0,0x5f,0x25,0x98,0xbd,0x0f,0xd2,0x21,0x5d,0x6a,0x1e,0x52,0x95,0xe6,0x4f,0x73,0xf6,0x3f,0x0a,0xec,0x8b,0x91,0x5a,0x98,0x5d,0x78,0x65,0x98,};


const u8 key_rfc4231_7[]={0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa};
const  u8 msg_rfc4231_7[]={0x54,0x68,0x69,0x73,0x20,0x69,0x73,0x20,0x61,0x20,0x74,0x65,0x73,0x74,0x20,0x75,0x73,0x69,0x6e,0x67,0x20,0x61,0x20,0x6c,0x61,0x72,0x67,0x65,0x72,0x20,0x74,0x68,0x61,0x6e,0x20,0x62,0x6c,0x6f,0x63,0x6b,0x2d,0x73,0x69,0x7a,0x65,0x20,0x6b,0x65,0x79,0x20,0x61,0x6e,0x64,0x20,0x61,0x20,0x6c,0x61,0x72,0x67,0x65,0x72,0x20,0x74,0x68,0x61,0x6e,0x20,0x62,0x6c,0x6f,0x63,0x6b,0x2d,0x73,0x69,0x7a,0x65,0x20,0x64,0x61,0x74,0x61,0x2e,0x20,0x54,0x68,0x65,0x20,0x6b,0x65,0x79,0x20,0x6e,0x65,0x65,0x64,0x73,0x20,0x74,0x6f,0x20,0x62,0x65,0x20,0x68,0x61,0x73,0x68,0x65,0x64,0x20,0x62,0x65,0x66,0x6f,0x72,0x65,0x20,0x62,0x65,0x69,0x6e,0x67,0x20,0x75,0x73,0x65,0x64,0x20,0x62,0x79,0x20,0x74,0x68,0x65,0x20,0x48,0x4d,0x41,0x43,0x20,0x61,0x6c,0x67,0x6f,0x72,0x69,0x74,0x68,0x6d,0x2e};

const u8 mac224_rfc4231_7[]={0x3a,0x85,0x41,0x66,0xac,0x5d,0x9f,0x02,0x3f,0x54,0xd5,0x17,0xd0,0xb3,0x9d,0xbd,0x94,0x67,0x70,0xdb,0x9c,0x2b,0x95,0xc9,0xf6,0xf5,0x65,0xd1};
u8 mac256_rfc4231_7[]={0x9b,0x09,0xff,0xa7,0x1b,0x94,0x2f,0xcb,0x27,0x63,0x5f,0xbc,0xd5,0xb0,0xe9,0x44,0xbf,0xdc,0x63,0x64,0x4f,0x07,0x13,0x93,0x8a,0x7f,0x51,0x53,0x5c,0x3a,0x35,0xe2};
const u8 mac384_rfc4231_7[]={0x66,0x17,0x17,0x8e,0x94,0x1f,0x02,0x0d,0x35,0x1e,0x2f,0x25,0x4e,0x8f,0xd3,0x2c,0x60,0x24,0x20,0xfe,0xb0,0xb8,0xfb,0x9a,0xdc,0xce,0xbb,0x82,0x46,0x1e,0x99,0xc5,0xa6,0x78,0xcc,0x31,0xe7,0x99,0x17,0x6d,0x38,0x60,0xe6,0x11,0x0c,0x46,0x52,0x3e};
const u8 mac512_rfc4231_7[]={0xe3,0x7b,0x6a,0x77,0x5d,0xc8,0x7d,0xba,0xa4,0xdf,0xa9,0xf9,0x6e,0x5e,0x3f,0xfd,0xde,0xbd,0x71,0xf8,0x86,0x72,0x89,0x86,0x5d,0xf5,0xa3,0x2d,0x20,0xcd,0xc9,0x44,0xb6,0x02,0x2c,0xac,0x3c,0x49,0x82,0xb1,0x0d,0x5e,0xeb,0x55,0xc3,0xe4,0xde,0x15,0x13,0x46,0x76,0xfb,0x6d,0xe0,0x44,0x60,0x65,0xc9,0x74,0x40,0xfa,0x8c,0x6a,0x58};

int hex(char c1,char c2)
{
  int value;
  value=0;
  if(c1>='A' && c1<='F')
    value=(c1-'A'+10);
  if(c1>='a' && c1<='f')
    value=(c1-'a'+10);
  if(c1>='0' && c1<='9')
    value=(c1-'0');
  value*=16;
  if(c2>='A' && c2<='F')
    value+=(c2-'A'+10);
  if(c2>='a' && c2<='f')
    value+=(c2-'a'+10);
  if(c2>='0' && c2<='9')
    value+=(c2-'0');
  return(value);
}

int check(u8 *h,char *sth,int l)
{
  int i;
  //max size of a hash digest
  u8 th[64];
  if((int)strlen(sth)!=l*2)
    {
      PRINTF("ERROR: incorrect string length (%d -> %d\n",(int)strlen(sth),l);
      return(UCL_ERROR);
    }
  for(i=0;i<l;i++)
    th[i]=hex(sth[i*2],sth[i*2+1]);
  if(memcmp(h,th,l)==0)
    {
    PRINTF("OK\n");
    }
  else
    return(UCL_ERROR);
  return(UCL_OK);
}

#ifdef HASH_SHA1
int sample_sha1(void)
{
  // FIPS 180-2 sample vectors
  // "abc" l=24b
  //  u8 vd_data[]={"qnjftuertugwpxhzsiwhxywsmxlkuzpjfxoumtnckbbpeutikwtzdia"};
  u8 shadata1[]={0x61,0x62,0x63};
  u8 shares1[]={0xa9,0x99,0x3e,0x36,0x47,0x06,0x81,0x6a,0xba,0x3e,0x25,0x71,0x78,0x50,0xc2,0x6c,0x9c,0xd0,0xd8,0x9d};

  u8 shadata2[]={0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x10,0x11,0x12,0x13,0x14};
  u8 shares2[]={0x6d,0x99,0x6c,0xd5,0x77,0x51,0x5f,0x17,0x6c,0xa8,0x76,0x8e,0xe6,0x92,0x18,0x3f,0x5e,0x60,0x82,0xfe};

  // "abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq" l=448b
  u8 shadata3[]={0x61,0x62,0x63,0x64,0x62,0x63,0x64,0x65,0x63,0x64,0x65,0x66,0x64,0x65,0x66,0x67,0x65,0x66,0x67,0x68,0x66,0x67,0x68,0x69,0x67,0x68,0x69,0x6A,0x68,0x69,0x6A,0x6B,0x69,0x6A,0x6B,0x6C,0x6A,0x6B,0x6C,0x6D,0x6B,0x6C,0x6D,0x6E,0x6C,0x6D,0x6E,0x6F,0x6D,0x6E,0x6F,0x70,0x6E,0x6F,0x70,0x71};
  u8 shares3[]={0x84,0x98,0x3E,0x44,0x1C,0x3B,0xD2,0x6E,0xBA,0xAE,0x4A,0xA1,0xF9,0x51,0x29,0xE5,0xE5,0x46,0x70,0xF1};

  //data=1 million "a" 1 million 61
  u8 shares4[]={0x34,0xAA,0x97,0x3C,0xD4,0xC4,0xDA,0xA4,0xF6,0x1E,0xEB,0x2B,0xDB,0xAD,0x27,0x31,0x65,0x34,0x01,0x6F};

  int err;
  u8 digest[UCL_SHA1_HASHSIZE];
  u8 million[1000];
  int i;
  ucl_sha1_ctx_t ctxt;


  err=ucl_sha1(digest,shadata1,sizeof(shadata1));
  if(err!=UCL_OK)
    return(UCL_ERROR);
  if(memcmp(digest,shares1,UCL_SHA1_HASHSIZE)!=0)
    {
      return(UCL_ERROR);
    }
  err=ucl_sha1(digest,shadata2,sizeof(shadata2));
  if(err!=UCL_OK)
    return(UCL_ERROR);
  if(memcmp(digest,shares2,UCL_SHA1_HASHSIZE)!=0)
    return(UCL_ERROR);
  err=ucl_sha1(digest,shadata3,sizeof(shadata3));
  if(err!=UCL_OK)
    return(UCL_ERROR);
  if(memcmp(digest,shares3,UCL_SHA1_HASHSIZE)!=0)
    return(UCL_ERROR);
  for(i=0;i<1000;i++)
    million[i]='a';
  ucl_sha1_init(&ctxt);
  for(i=0;i<1000000/1000;i++)
    ucl_sha1_core(&ctxt,million,sizeof(million));
  ucl_sha1_finish(digest,&ctxt);
  if(memcmp(digest,shares4,UCL_SHA1_HASHSIZE)!=0)
    return(UCL_ERROR);
  return(UCL_OK);
}

int test_sha1(void)
{
  return(sample_sha1());
}

#endif//HASH_SHA1


#ifdef HASH_SM3
int test_sm3(void)
{
  u8 digest[32];
  u8 msg1[]={0x61,0x62,0x63};
  u8 result1[]={0x66,0xc7,0xf0,0xf4,0x62,0xee,0xed,0xd9,0xd1,0xf2,0xd4,0x6b,0xdc,0x10,0xe4,0xe2,0x41,0x67,0xc4,0x87,0x5c,0xf2,0xf7,0xa2,0x29,0x7d,0xa0,0x2b,0x8f,0x4b,0xa8,0xe0};
  u8 msg2[]={0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64,0x61,0x62,0x63,0x64};
  u8 result2[]={0xde,0xbe,0x9f,0xf9,0x22,0x75,0xb8,0xa1,0x38,0x60,0x48,0x89,0xc1,0x8e,0x5a,0x4d,0x6f,0xdb,0x70,0xe5,0x38,0x7e,0x57,0x65,0x29,0x3d,0xcb,0xa3,0x9c,0x0c,0x57,0x32};
  PRINTF("SM3 HASH TEST\n");
  ucl_sm3(digest,msg1,3);
  if(memcmp(digest,result1,32)!=0)
    {
      PRINTF("ERROR SM3 MSG1\n");
      return(UCL_ERROR);
    }
  else
    {
    PRINTF("SM3 MSG1 OK\n");
    }
  ucl_sm3(digest,msg2,64);
  if(memcmp(digest,result2,32)!=0)
    {
      PRINTF("ERROR SM3 MSG2\n");
      return(UCL_ERROR);
    }
  else
    {
    PRINTF("SM3 MSG2 OK\n");
    }
  PRINTF("SM3 HASH TEST -END\n");
  return(UCL_OK);
}
#endif//SM3


#ifdef HASH_SHA512
int test_sha512(void)
{
  /*
SHA-512 Test Data
#1) 0 byte (null message)
cf83e1357eefb8bd f1542850d66d8007 d620e4050b5715dc 83f4a921d36ce9ce
47d0d13c5d85f2b0 ff8318d2877eec2f 63b931bd47417a81 a538327af927da3e

#2) 111 bytes of zeros

77ddd3a542e530fd 047b8977c657ba6c e72f1492e360b2b2 212cd264e75ec038
82e4ff0525517ab4 207d14c70c2259ba 88d4d335ee0e7e20 543d22102ab1788c
#3) 112 bytes of zeros
2be2e788c8a8adea a9c89a7f78904cac ea6e39297d75e057 3a73c756234534d6
627ab4156b48a665 7b29ab8beb733340 40ad39ead81446bb 09c70704ec707952
#4) 113 bytes of zeros
0e67910bcf0f9ccd e5464c63b9c850a1 2a759227d16b040d 98986d54253f9f34
322318e56b8feb86 c5fb2270ed87f312 52f7f68493ee7597 43909bd75e4bb544
#5) 122 bytes of zeros
4f3f095d015be4a7 a7cc0b8c04da4aa0 9e74351e3a97651f 744c23716ebd9b3e
822e5077a01baa5c c0ed45b9249e88ab 343d4333539df21e d229da6f4a514e0f
#6) 1000 bytes of zeros
ca3dff61bb23477a a6087b27508264a6 f9126ee3a004f53c b8db942ed345f2f2
d229b4b59c859220 a1cf1913f34248e3 803bab650e849a3d 9a709edc09ae4a76
#7) 1000 bytes of 0x41 ‘A’
329c52ac62d1fe73 1151f2b895a00475 445ef74f50b979c6 f7bb7cae349328c1
d4cb4f7261a0ab43 f936a24b000651d4 a824fcdd577f211a ef8f806b16afe8af
#8) 1005 bytes of 0x55 ‘U’
59f5e54fe299c6a8 764c6b199e44924a 37f59e2b56c3ebad 939b7289210dc8e4
c21b9720165b0f4d 4374c90f1bf4fb4a 5ace17a116179801 5052893a48c3d161
#9) 1000000 bytes of zeros
ce044bc9fd43269d 5bbc946cbebc3bb7 11341115cc4abdf2 edbc3ff2c57ad4b1
5deb699bda257fea 5aef9c6e55fcf4cf 9dc25a8c3ce25f2e fe90908379bff7ed
#10) 0x20000000 (536870912) bytes of 0x5a ‘Z’
da172279f3ebbda9 5f6b6e1e5f0ebec6 82c25d3d93561a16 24c2fa9009d64c7e
9923f3b46bcaf11d 39a531f43297992b a4155c7e827bd0f1 e194ae7ed6de4cac
#11) 0x41000000 (1090519040) bytes of zeros
14b1be901cb43549 b4d831e61e5f9df1 c791c85b50e85f9d 6bc64135804ad43c
e8402750edbe4e5c 0fc170b99cf78b9f 4ecb9c7e02a15791 1d1bd1832d76784f
#12) 0x6000003e (1610612798) bytes of 0x42 ‘B’
fd05e13eb771f051 90bd97d62647157e a8f1f6949a52bb6d aaedbad5f578ec59
b1b8d6c4a7ecb2fe ca6892b4dc138771 670a0f3bd577eea3 26aed40ab7dd58b1
  */
  int i;
  ucl_sha512_ctx_t ctx;
  u8 e[UCL_SHA512_HASHSIZE];
  u8 mabc[3]={'a','b','c'};
  u8 mtwoblock512[]={"abcdefghbcdefghicdefghijdefghijkefghijklfghijklmghijklmnhijklmnoijklmnopjklmnopqklmnopqrlmnopqrsmnopqrstnopqrstu"};
  u8 tab[1005];
  //  ucl_sha256(e,mabc,3);
  PRINTF("TEST SHA512\n");
  ucl_sha512(e,mabc,0);
  PRINTF("sha512(void):");
  if(UCL_OK!=check(e,"cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e",64))
    return(UCL_ERROR);
  ucl_sha512(e,mabc,3);
  PRINTF("sha512(abc):");
  if(UCL_OK!=check(e,"ddaf35a193617abacc417349ae20413112e6fa4e89a97ea20a9eeee64b55d39a2192992a274fc1a836ba3c23a3feebbd454d4423643ce80e2a9ac94fa54ca49f",64))
    return(UCL_ERROR);
  ucl_sha512(e,mtwoblock512,112);
  PRINTF("sha512(2blocks):");
  if(UCL_OK!=check(e,"8e959b75dae313da8cf4f72814fc143f8f7779c6eb9f7fa17299aeadb6889018501d289e4900f7e4331b99dec4b5433ac7d329eeb6dd26545e96e55b874be909",64))
    return(UCL_ERROR);
  for(i=0;i<1000;i++)
    tab[i]=0;
  ucl_sha512(e,tab,111);
  PRINTF("sha512(111-0):");
  if(UCL_OK!=check(e,"77ddd3a542e530fd047b8977c657ba6ce72f1492e360b2b2212cd264e75ec03882e4ff0525517ab4207d14c70c2259ba88d4d335ee0e7e20543d22102ab1788c",64))
    return(UCL_ERROR);

  ucl_sha512(e,tab,112);
  PRINTF("sha512(112-0):");
  if(UCL_OK!=check(e,"2be2e788c8a8adeaa9c89a7f78904cacea6e39297d75e0573a73c756234534d6627ab4156b48a6657b29ab8beb73334040ad39ead81446bb09c70704ec707952",64))
    return(UCL_ERROR);

  ucl_sha512(e,tab,113);
  PRINTF("sha512(113-0):");
  if(UCL_OK!=check(e,"0e67910bcf0f9ccde5464c63b9c850a12a759227d16b040d98986d54253f9f34322318e56b8feb86c5fb2270ed87f31252f7f68493ee759743909bd75e4bb544",64))
    return(UCL_ERROR);
  ucl_sha512(e,tab,122);
  PRINTF("sha512(122-0):");
  //#5) 122 bytes of zeros
  if(UCL_OK!=check(e,"4f3f095d015be4a7a7cc0b8c04da4aa09e74351e3a97651f744c23716ebd9b3e822e5077a01baa5cc0ed45b9249e88ab343d4333539df21ed229da6f4a514e0f",64))
    return(UCL_ERROR);

  ucl_sha512(e,tab,1000);
  PRINTF("sha512(1000-0):");
  //#6) 1000 bytes of zeros
  if(UCL_OK!=check(e,"ca3dff61bb23477aa6087b27508264a6f9126ee3a004f53cb8db942ed345f2f2d229b4b59c859220a1cf1913f34248e3803bab650e849a3d9a709edc09ae4a76",64))
    return(UCL_ERROR);

  for(i=0;i<1000;i++)
    tab[i]='A';
  ucl_sha512(e,tab,1000);
  PRINTF("sha512(1000-A):");
  //#7) 1000 bytes of 0x41 ‘A’
  if(UCL_OK!=check(e,"329c52ac62d1fe731151f2b895a00475445ef74f50b979c6f7bb7cae349328c1d4cb4f7261a0ab43f936a24b000651d4a824fcdd577f211aef8f806b16afe8af",64))
    return(UCL_ERROR);

  for(i=0;i<1005;i++)
    tab[i]='U';
  ucl_sha512(e,tab,1005);
  PRINTF("sha512(1005-U):");
  //#8) 1005 bytes of 0x55 ‘U’
  if(UCL_OK!=check(e,"59f5e54fe299c6a8764c6b199e44924a37f59e2b56c3ebad939b7289210dc8e4c21b9720165b0f4d4374c90f1bf4fb4a5ace17a1161798015052893a48c3d161",64))
    return(UCL_ERROR);

  for(i=0;i<1000;i++)
    tab[i]=0;
  ucl_sha512_init(&ctx);
  for(i=0;i<1000;i++)
    ucl_sha512_core(&ctx,tab,1000);
  ucl_sha512_finish(e,&ctx);
  PRINTF("sha512(1mil-0):");
  //#9) 1000000 bytes of zeros
  if(UCL_OK!=check(e,"ce044bc9fd43269d5bbc946cbebc3bb711341115cc4abdf2edbc3ff2c57ad4b15deb699bda257fea5aef9c6e55fcf4cf9dc25a8c3ce25f2efe90908379bff7ed",64))
    return(UCL_ERROR);

  for(i=0;i<512;i++)
    tab[i]='Z';
  ucl_sha512_init(&ctx);
  for(i=0;i<1048576;i++)
    {
      if((i%10000)==0)
	PRINTF("#%d ",i);
    ucl_sha512_core(&ctx,tab,512);
    }
  ucl_sha512_finish(e,&ctx);
  PRINTF("sha512(2^29-Z):");
  //#10) 0x20000000 (536870912) bytes of 0x5a ‘Z’
  if(UCL_OK!=check(e,"da172279f3ebbda95f6b6e1e5f0ebec682c25d3d93561a1624c2fa9009d64c7e9923f3b46bcaf11d39a531f43297992ba4155c7e827bd0f1e194ae7ed6de4cac",64))
    return(UCL_ERROR);

  for(i=0;i<520;i++)
    tab[i]=0;
  ucl_sha512_init(&ctx);
  for(i=0;i<2097152;i++)
    {
      if((i%10000)==0)
	PRINTF("#%d ",i);
      ucl_sha512_core(&ctx,tab,520);
    }
  ucl_sha512_finish(e,&ctx);
  PRINTF("sha512(2^24*5*13-0):");
  //#11) 0x41000000 (1090519040) bytes of zeros
  if(UCL_OK!=check(e,"14b1be901cb43549b4d831e61e5f9df1c791c85b50e85f9d6bc64135804ad43ce8402750edbe4e5c0fc170b99cf78b9f4ecb9c7e02a157911d1bd1832d76784f",64))
    return(UCL_ERROR);

  for(i=0;i<118;i++)
    tab[i]='B';
  ucl_sha512_init(&ctx);
  for(i=0;i<13649261;i++)
    ucl_sha512_core(&ctx,tab,118);
  ucl_sha512_finish(e,&ctx);
  PRINTF("sha512(2*59*13649261-'B'):");
  //#12) 0x6000003e (1610612798) bytes of 0x42 ‘B’
  if(UCL_OK!=check(e,"fd05e13eb771f05190bd97d62647157ea8f1f6949a52bb6daaedbad5f578ec59b1b8d6c4a7ecb2feca6892b4dc138771670a0f3bd577eea326aed40ab7dd58b1",64))
    return(UCL_ERROR);
  return(UCL_OK);
}

int sample_hmac512(void)
{
  //NIST SHA512 examples
  u8 test1[]={"Sample message for keylen<blocklen"};
  u8 shakey1[]={0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,0x0D,0x0E,0x0F,0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1A,0x1B,0x1C,0x1D,0x1E,0x1F,0x20,0x21,0x22,0x23,0x24,0x25,0x26,0x27,0x28,0x29,0x2A,0x2B,0x2C,0x2D,0x2E,0x2F,0x30,0x31,0x32,0x33,0x34,0x35,0x36,0x37,0x38,0x39,0x3A,0x3B,0x3C,0x3D,0x3E,0x3F};
  u8 sharesu1[]={0xFD,0x44,0xC1,0x8B,0xDA,0x0B,0xB0,0xA6,0xCE,0x0E,0x82,0xB0,0x31,0xBF,0x28,0x18,0xF6,0x53,0x9B,0xD5,0x6E,0xC0,0x0B,0xDC,0x10,0xA8,0xA2,0xD7,0x30,0xB3,0x63,0x4D,0xE2,0x54,0x5D,0x63,0x9B,0x0F,0x2C,0xF7,0x10,0xD0,0x69,0x2C,0x72,0xA1,0x89,0x6F,0x1F,0x21,0x1C,0x2B,0x92,0x2D,0x1A,0x96,0xC3,0x92,0xE0,0x7E,0x7E,0xA9,0xFE,0xDC};

  u8 test2[]={"Sample message for keylen=blocklen"};
  u8 shakey2[]={0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,0x0D,0x0E,0x0F,0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1A,0x1B,0x1C,0x1D,0x1E,0x1F,0x20,0x21,0x22,0x23,0x24,0x25,0x26,0x27,0x28,0x29,0x2A,0x2B,0x2C,0x2D,0x2E,0x2F,0x30,0x31,0x32,0x33,0x34,0x35,0x36,0x37,0x38,0x39,0x3A,0x3B,0x3C,0x3D,0x3E,0x3F,0x40,0x41,0x42,0x43,0x44,0x45,0x46,0x47,0x48,0x49,0x4A,0x4B,0x4C,0x4D,0x4E,0x4F,0x50,0x51,0x52,0x53,0x54,0x55,0x56,0x57,0x58,0x59,0x5A,0x5B,0x5C,0x5D,0x5E,0x5F,0x60,0x61,0x62,0x63,0x64,0x65,0x66,0x67,0x68,0x69,0x6A,0x6B,0x6C,0x6D,0x6E,0x6F,0x70,0x71,0x72,0x73,0x74,0x75,0x76,0x77,0x78,0x79,0x7A,0x7B,0x7C,0x7D,0x7E,0x7F,0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,0x8A,0x8B,0x8C,0x8D,0x8E,0x8F,0x90,0x91,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99,0x9A,0x9B,0x9C,0x9D,0x9E,0x9F,0xA0,0xA1,0xA2,0xA3,0xA4,0xA5,0xA6,0xA7,0xA8,0xA9,0xAA,0xAB,0xAC,0xAD,0xAE,0xAF,0xB0,0xB1,0xB2,0xB3,0xB4,0xB5,0xB6,0xB7,0xB8,0xB9,0xBA,0xBB,0xBC,0xBD,0xBE,0xBF,0xC0,0xC1,0xC2,0xC3,0xC4,0xC5,0xC6,0xC7};
  u8 sharesu2[]={0xD9,0x3E,0xC8,0xD2,0xDE,0x1A,0xD2,0xA9,0x95,0x7C,0xB9,0xB8,0x3F,0x14,0xE7,0x6A,0xD6,0xB5,0xE0,0xCC,0xE2,0x85,0x07,0x9A,0x12,0x7D,0x3B,0x14,0xBC,0xCB,0x7A,0xA7,0x28,0x6D,0x4A,0xC0,0xD4,0xCE,0x64,0x21,0x5F,0x2B,0xC9,0xE6,0x87,0x0B,0x33,0xD9,0x74,0x38,0xBE,0x4A,0xAA,0x20,0xCD,0xA5,0xC5,0xA9,0x12,0xB4,0x8B,0x8E,0x27,0xF3};

  u8 test3[]={"Hi There"};
  u8 shakey3[20]={0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b};

  u8 sharesu3[UCL_SHA512_HASHSIZE]={0x87,0xaa,0x7c,0xde,0xa5,0xef,0x61,0x9d,0x4f,0xf0,0xb4,0x24,0x1a,0x1d,0x6c,0xb0,0x23,0x79,0xf4,0xe2,0xce,0x4e,0xc2,0x78,0x7a,0xd0,0xb3,0x05,0x45,0xe1,0x7c,0xde,0xda,0xa8,0x33,0xb7,0xd6,0xb8,0xa7,0x02,0x03,0x8b,0x27,0x4e,0xae,0xa3,0xf4,0xe4,0xbe,0x9d,0x91,0x4e,0xeb,0x61,0xf1,0x70,0x2e,0x69,0x6c,0x20,0x3a,0x12,0x68,0x54};

  int err;
  u8 sharesult[UCL_SHA512_HASHSIZE];
  int i;
  PRINTF("HMAC-SHA512\n");
  err=ucl_hmac_sha512(sharesult, UCL_SHA512_HASHSIZE,test3 , 8, shakey3, 20);
  if(err!=UCL_OK)
    {
      PRINTF("ERROR UCL_HMAC_SHA512 test3 RETURN \n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,sharesu3,UCL_SHA512_HASHSIZE)!=0)
    {
      PRINTF("ERROR UCL_HMAC_SHA512 test3\n");
      for(i=0;i<UCL_SHA512_HASHSIZE;i++)
	PRINTF("%02x",sharesult[i]);
      PRINTF("\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("test3 OK\n");
  err=ucl_hmac_sha512(sharesult, UCL_SHA512_HASHSIZE,test2 , 34, shakey2, 200);
  if(err!=UCL_OK)
    {
      PRINTF("ERROR UCL_HMAC_SHA512 test2 RETURN \n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,sharesu2,UCL_SHA512_HASHSIZE)!=0)
    {
      PRINTF("ERROR UCL_HMAC_SHA512 test2\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("test2 OK\n");
  err=ucl_hmac_sha512 (sharesult, UCL_SHA512_HASHSIZE,test1 , 34, shakey1, 64);
  if(err!=UCL_OK)
    {
      PRINTF("ERROR UCL_HMAC_SHA512 test1 RETURN \n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,sharesu1,UCL_SHA512_HASHSIZE)!=0)
    {
      PRINTF("ERROR UCL_HMAC_SHA512 test1\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("test1 OK\n");
  err=ucl_hmac_sha512 (sharesult, UCL_SHA512_HASHSIZE,msg_rfc4231_1 , sizeof(msg_rfc4231_1), key_rfc4231_1, sizeof(key_rfc4231_1));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA512\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac512_rfc4231_1,UCL_SHA512_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA512 RFC #1\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA512 RFC #1 OK\n");
  err=ucl_hmac_sha512 (sharesult, UCL_SHA512_HASHSIZE,msg_rfc4231_2 , sizeof(msg_rfc4231_2), key_rfc4231_2, sizeof(key_rfc4231_2));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA512\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac512_rfc4231_2,UCL_SHA512_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA512 RFC #2\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA512 RFC #2 OK\n");
  err=ucl_hmac_sha512 (sharesult, UCL_SHA512_HASHSIZE,msg_rfc4231_3 , sizeof(msg_rfc4231_3), key_rfc4231_3, sizeof(key_rfc4231_3));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA512\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac512_rfc4231_3,UCL_SHA512_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA512 RFC #3\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA512 RFC #3 OK\n");
  err=ucl_hmac_sha512 (sharesult, UCL_SHA512_HASHSIZE,msg_rfc4231_4 , sizeof(msg_rfc4231_4), key_rfc4231_4, sizeof(key_rfc4231_4));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA512\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac512_rfc4231_4,UCL_SHA512_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA512 RFC #4\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA512 RFC #4 OK\n");
  err=ucl_hmac_sha512 (sharesult, UCL_SHA512_HASHSIZE,msg_rfc4231_6 , sizeof(msg_rfc4231_6), key_rfc4231_6, sizeof(key_rfc4231_6));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA512\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac512_rfc4231_6,UCL_SHA512_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA512 RFC #6\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA512 RFC #6 OK\n");
  err=ucl_hmac_sha512 (sharesult, UCL_SHA512_HASHSIZE, (u8 *)msg_rfc4231_7 , sizeof(msg_rfc4231_7), (u8 *)key_rfc4231_7, sizeof(key_rfc4231_7));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA512\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac512_rfc4231_7,UCL_SHA512_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA512 RFC #7\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA512 RFC #7 OK\n");
  return(UCL_OK);
}

#endif//HASH_SHA512

#ifdef HASH_SHA384
int test_sha384(void)
{
  /*
SHA-384 Test Data
#1) 0 byte (null message)
38b060a751ac9638 4cd9327eb1b1e36a 21fdb71114be0743 4c0cc7bf63f6e1da
274edebfe76f65fb d51ad2f14898b95b
#2) 111 bytes of zeros
435770712c611be7 293a66dd0dc8d145 0dc7ff7337bfe115 bf058ef2eb9bed09
cee85c26963a5bcc 0905dc2df7cc6a76
#3) 112 bytes of zeros
3e0cbf3aee0e3aa7 0415beae1bd12dd7 db821efa446440f1 2132edffce76f635
e53526a111491e75 ee8e27b9700eec20
#4) 113 bytes of zeros
6be9af2cf3cd5dd1 2c8d9399ec2b34e6 6034fbd699d4e022 1d39074172a38065
6089caafe8f39963 f94cc7c0a07e3d21
#5) 122 bytes of zeros
12a72ae4972776b0 db7d73d160a15ef0 d19645ec96c7f816 411ab780c794aa49
6a22909d941fe671 ed3f3caee900bdd5
#6) 1000 bytes of zeros
aae017d4ae5b6346 dd60a19d52130fb5 5194b6327dd40b89 c11efc8222292de8
1e1a23c9b59f9f58 b7f6ad463fa108ca
#7) 1000 bytes of 0x41 'A'
7df01148677b7f18 617eee3a23104f0e ed6bb8c90a6046f7 15c9445ff43c30d6
9e9e7082de39c345 2fd1d3afd9ba0689
#8) 1005 bytes of 0x55 'U'
1bb8e256da4a0d1e 87453528254f223b 4cb7e49c4420dbfa 766bba4adba44eec
a392ff6a9f565bc3 47158cc970ce44ec
#9) 1000000 bytes of zeros
8a1979f9049b3fff 15ea3a43a4cf84c6 34fd14acad1c333f ecb72c588b68868b
66a994386dc0cd16 87b9ee2e34983b81
#10) 0x20000000 (536870912) bytes of 0x5a 'Z'
18aded227cc6b562 cc7fb259e8f40454 9e52914531aa1c5d 85167897c779cc4b
25d0425fd1590e40 bd763ec3f4311c1a
#11) 0x41000000 (1090519040) bytes of zeros
83ab05ca483abe3f aa597ad524d31291 ae827c5be2b3efcb 6391bfed31ccd937
b6135e0378c6c7f5 98857a7c516f207a
#12) 0x6000003e (1610612798) bytes of 0x42 'B'
cf852304f8d80209 351b37ce69ca7dcf 34972b4edb781702 8ec55ab67ad3bc96
eecb8241734258a8 5d2afce65d4571e2
  */
  int i;
  ucl_sha384_ctx_t ctx;
  u8 e[UCL_SHA384_HASHSIZE];
  u8 tab[1005];
  PRINTF("TEST SHA384\n");
  PRINTF("sha384(void):");
  ucl_sha384(e,tab,0);
  //  display("e:",e,64);
  //#1) 0 byte (null message)
  if(UCL_OK!=check(e,"38b060a751ac96384cd9327eb1b1e36a21fdb71114be07434c0cc7bf63f6e1da274edebfe76f65fbd51ad2f14898b95b",48))
    return(UCL_ERROR);

  for(i=0;i<1000;i++)
    tab[i]=0;
  ucl_sha384(e,tab,111);
  PRINTF("sha384(111-0):");
  //  display("e:",e,48);
  //#2) 111 bytes of zeros
  if(UCL_OK!=check(e,"435770712c611be7293a66dd0dc8d1450dc7ff7337bfe115bf058ef2eb9bed09cee85c26963a5bcc0905dc2df7cc6a76",48))
    return(UCL_ERROR);

  ucl_sha384(e,tab,112);
  PRINTF("sha384(112-0):");
  //  display("e:",e,48);
  //#3) 112 bytes of zeros
  if(UCL_OK!=check(e,"3e0cbf3aee0e3aa70415beae1bd12dd7db821efa446440f12132edffce76f635e53526a111491e75ee8e27b9700eec20",48))
    return(UCL_ERROR);

  ucl_sha384(e,tab,113);
  PRINTF("sha384(113-0):");
  //  display("e:",e,48);
  //#4) 113 bytes of zeros
  if(UCL_OK!=check(e,"6be9af2cf3cd5dd12c8d9399ec2b34e66034fbd699d4e0221d39074172a380656089caafe8f39963f94cc7c0a07e3d21",48))
    return(UCL_ERROR);

  ucl_sha384(e,tab,122);
  PRINTF("sha384(122-0):");
  //  display("e:",e,48);
  //#5) 122 bytes of zeros
  if(UCL_OK!=check(e,"12a72ae4972776b0db7d73d160a15ef0d19645ec96c7f816411ab780c794aa496a22909d941fe671ed3f3caee900bdd5",48))
    return(UCL_ERROR);

  ucl_sha384(e,tab,1000);
  PRINTF("sha384(1000-0):");
  //  display("e:",e,48);
  //#6) 1000 bytes of zeros
  if(UCL_OK!=check(e,"aae017d4ae5b6346dd60a19d52130fb55194b6327dd40b89c11efc8222292de81e1a23c9b59f9f58b7f6ad463fa108ca",48))
    return(UCL_ERROR);

  for(i=0;i<1000;i++)
    tab[i]='A';
  ucl_sha384(e,tab,1000);
  PRINTF("sha384(1000-A):");
  //  display("e:",e,48);
  //#7) 1000 bytes of 0x41 'A'
  if(UCL_OK!=check(e,"7df01148677b7f18617eee3a23104f0eed6bb8c90a6046f715c9445ff43c30d69e9e7082de39c3452fd1d3afd9ba0689",48))
    return(UCL_ERROR);

  for(i=0;i<1005;i++)
    tab[i]='U';
  ucl_sha384(e,tab,1005);
  PRINTF("sha384(1005-U):");
  //  display("e:",e,48);
  //#8) 1005 bytes of 0x55 'U'
  if(UCL_OK!=check(e,"1bb8e256da4a0d1e87453528254f223b4cb7e49c4420dbfa766bba4adba44eeca392ff6a9f565bc347158cc970ce44ec",48))
    return(UCL_ERROR);

  for(i=0;i<1000;i++)
    tab[i]=0;
  ucl_sha384_init(&ctx);
  for(i=0;i<1000;i++)
    ucl_sha384_core(&ctx,tab,1000);
  ucl_sha384_finish(e,&ctx);
  PRINTF("sha384(1mil-0):");
  //#9) 1000000 bytes of zeros
  if(UCL_OK!=check(e,"8a1979f9049b3fff15ea3a43a4cf84c634fd14acad1c333fecb72c588b68868b66a994386dc0cd1687b9ee2e34983b81",48))
    return(UCL_ERROR);

  for(i=0;i<512;i++)
    tab[i]='Z';
  ucl_sha384_init(&ctx);
  for(i=0;i<1048576;i++)
    {
      if((i%1024)==0)
	PRINTF("#%d\n",i);
      ucl_sha384_core(&ctx,tab,512);
    }
  ucl_sha384_finish(e,&ctx);
  PRINTF("sha384(2^29-Z):");
  //#10) 0x20000000 (536870912) bytes of 0x5a 'Z'
  if(UCL_OK!=check(e,"18aded227cc6b562cc7fb259e8f404549e52914531aa1c5d85167897c779cc4b25d0425fd1590e40bd763ec3f4311c1a",48))
    return(UCL_ERROR);

  for(i=0;i<520;i++)
    tab[i]=0;
  ucl_sha384_init(&ctx);
  for(i=0;i<2097152;i++)
    ucl_sha384_core(&ctx,tab,520);
  ucl_sha384_finish(e,&ctx);
  PRINTF("sha384(2^24*5*13-0):");
  //#11) 0x41000000 (1090519040) bytes of zeros
  if(UCL_OK!=check(e,"83ab05ca483abe3faa597ad524d31291ae827c5be2b3efcb6391bfed31ccd937b6135e0378c6c7f598857a7c516f207a",48))
    return(UCL_ERROR);

  for(i=0;i<118;i++)
    tab[i]='B';
  ucl_sha384_init(&ctx);
  for(i=0;i<13649261;i++)
    ucl_sha384_core(&ctx,tab,118);
  ucl_sha384_finish(e,&ctx);
  PRINTF("sha384(2*59*13649261-'B'):");
  //#12) 0x6000003e (1610612798) bytes of 0x42 'B'
  if(UCL_OK!=check(e,"cf852304f8d80209351b37ce69ca7dcf34972b4edb7817028ec55ab67ad3bc96eecb8241734258a85d2afce65d4571e2",48))
    return(UCL_ERROR);
  return(UCL_OK);
}
int sample_hmac384(void)
{
  //NIST SHA384 examples
  u8 test1[]={"Sample message for keylen<blocklen"};
  u8 shakey1[]={0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,0x0D,0x0E,0x0F,0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1A,0x1B,0x1C,0x1D,0x1E,0x1F,0x20,0x21,0x22,0x23,0x24,0x25,0x26,0x27,0x28,0x29,0x2A,0x2B,0x2C,0x2D,0x2E,0x2F};
  u8 sharesu1[]={0x6E,0xB2,0x42,0xBD,0xBB,0x58,0x2C,0xA1,0x7B,0xEB,0xFA,0x48,0x1B,0x1E,0x23,0x21,0x14,0x64,0xD2,0xB7,0xF8,0xC2,0x0B,0x9F,0xF2,0x20,0x16,0x37,0xB9,0x36,0x46,0xAF,0x5A,0xE9,0xAC,0x31,0x6E,0x98,0xDB,0x45,0xD9,0xCA,0xE7,0x73,0x67,0x5E,0xEE,0xD0};

  u8 test2[]={"Sample message for keylen=blocklen"};
  u8 shakey2[]={0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,0x0D,0x0E,0x0F,0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1A,0x1B,0x1C,0x1D,0x1E,0x1F,0x20,0x21,0x22,0x23,0x24,0x25,0x26,0x27,0x28,0x29,0x2A,0x2B,0x2C,0x2D,0x2E,0x2F,0x30,0x31,0x32,0x33,0x34,0x35,0x36,0x37,0x38,0x39,0x3A,0x3B,0x3C,0x3D,0x3E,0x3F,0x40,0x41,0x42,0x43,0x44,0x45,0x46,0x47,0x48,0x49,0x4A,0x4B,0x4C,0x4D,0x4E,0x4F,0x50,0x51,0x52,0x53,0x54,0x55,0x56,0x57,0x58,0x59,0x5A,0x5B,0x5C,0x5D,0x5E,0x5F,0x60,0x61,0x62,0x63,0x64,0x65,0x66,0x67,0x68,0x69,0x6A,0x6B,0x6C,0x6D,0x6E,0x6F,0x70,0x71,0x72,0x73,0x74,0x75,0x76,0x77,0x78,0x79,0x7A,0x7B,0x7C,0x7D,0x7E,0x7F};
  u8 sharesu2[]={0x63,0xC5,0xDA,0xA5,0xE6,0x51,0x84,0x7C,0xA8,0x97,0xC9,0x58,0x14,0xAB,0x83,0x0B,0xED,0xED,0xC7,0xD2,0x5E,0x83,0xEE,0xF9,0x19,0x5C,0xD4,0x58,0x57,0xA3,0x7F,0x44,0x89,0x47,0x85,0x8F,0x5A,0xF5,0x0C,0xC2,0xB1,0xB7,0x30,0xDD,0xF2,0x96,0x71,0xA9};

  u8 test3[]={"Hi There"};
  u8 shakey3[20]={0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b};
  u8 sharesu3[48]={0xaf,0xd0,0x39,0x44,0xd8,0x48,0x95,0x62,0x6b,0x08,0x25,0xf4,0xab,0x46,0x90,0x7f,0x15,0xf9,0xda,0xdb,0xe4,0x10,0x1e,0xc6,0x82,0xaa,0x03,0x4c,0x7c,0xeb,0xc5,0x9c,0xfa,0xea,0x9e,0xa9,0x07,0x6e,0xde,0x7f,0x4a,0xf1,0x52,0xe8,0xb2,0xfa,0x9c,0xb6};
  int err;
  u8 sharesult[UCL_SHA384_HASHSIZE];
  PRINTF("HMAC-SHA384\n");
  err=ucl_hmac_sha384(sharesult, UCL_SHA384_HASHSIZE,test3 , 8, shakey3, 20);
  if(err!=UCL_OK)
    {
      PRINTF("ERROR UCL_HMAC_SHA384 test3 RETURN \n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,sharesu3,UCL_SHA384_HASHSIZE)!=0)
    {
      PRINTF("ERROR UCL_HMAC_SHA384 test3\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("test3 OK\n");
  err=ucl_hmac_sha384(sharesult, UCL_SHA384_HASHSIZE,test2 , 34, shakey2, 128);
  if(err!=UCL_OK)
    {
      PRINTF("ERROR UCL_HMAC_SHA384 test2 RETURN \n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,sharesu2,UCL_SHA384_HASHSIZE)!=0)
    {
      PRINTF("ERROR UCL_HMAC_SHA384 test2\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("test2 OK\n");
  err=ucl_hmac_sha384 (sharesult, UCL_SHA384_HASHSIZE,test1 , 34, shakey1, 48);
  if(err!=UCL_OK)
    {
      PRINTF("ERROR UCL_HMAC_SHA384 test1 RETURN \n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,sharesu1,UCL_SHA384_HASHSIZE)!=0)
    {
      PRINTF("ERROR UCL_HMAC_SHA384 test1\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("test1 OK\n");
  err=ucl_hmac_sha384 (sharesult, UCL_SHA384_HASHSIZE,msg_rfc4231_1 , sizeof(msg_rfc4231_1), key_rfc4231_1, sizeof(key_rfc4231_1));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA384\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac384_rfc4231_1,UCL_SHA384_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA384 RFC #1\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA384 RFC #1 OK\n");
  err=ucl_hmac_sha384 (sharesult, UCL_SHA384_HASHSIZE,msg_rfc4231_2 , sizeof(msg_rfc4231_2), key_rfc4231_2, sizeof(key_rfc4231_2));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA384\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac384_rfc4231_2,UCL_SHA384_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA384 RFC #2\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA384 RFC #2 OK\n");
  err=ucl_hmac_sha384 (sharesult, UCL_SHA384_HASHSIZE,msg_rfc4231_3 , sizeof(msg_rfc4231_3), key_rfc4231_3, sizeof(key_rfc4231_3));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA384\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac384_rfc4231_3,UCL_SHA384_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA384 RFC #3\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA384 RFC #3 OK\n");
  err=ucl_hmac_sha384 (sharesult, UCL_SHA384_HASHSIZE,msg_rfc4231_4 , sizeof(msg_rfc4231_4), key_rfc4231_4, sizeof(key_rfc4231_4));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA384\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac384_rfc4231_4,UCL_SHA384_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA384 RFC #4\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA384 RFC #4 OK\n");
  err=ucl_hmac_sha384 (sharesult, UCL_SHA384_HASHSIZE,msg_rfc4231_6 , sizeof(msg_rfc4231_6), key_rfc4231_6, sizeof(key_rfc4231_6));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA384\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac384_rfc4231_6,UCL_SHA384_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA384 RFC #6\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA384 RFC #6 OK\n");
  err=ucl_hmac_sha384 (sharesult, UCL_SHA384_HASHSIZE, (u8 *)msg_rfc4231_7 , sizeof(msg_rfc4231_7), (u8 *)key_rfc4231_7, sizeof(key_rfc4231_7));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA384\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac384_rfc4231_7,UCL_SHA384_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA384 RFC #7\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA384 RFC #7 OK\n");
  return(UCL_OK);
}

#endif//SHA384

#ifdef HASH_SIA256
int test_sia256(void)
{
  u8 sha256data1[]={0x05,0xC0,0x57,0x52,0x78,0xDA,0x49,0x02,0x2B,0x6E,0x3D,0x40,0x4F,0x8F,0xBD,0xAE,0x3D,0x41,0x55,0x2E,0x27,0x56,0xAF,0xBB,0x99,0x29,0x0A,0x1C,0xDF,0xFB,0xDD,0xE9,0x42,0xFE,0x32,0x56,0xD3,0xD6,0x7F,0xDA,0x1D,0xA0,0x4E,0xCA,0xBE,0x5E,0xFD,0xD5,0xCF,0xAF,0x7D,0xBA,0xA2,0x16,0x68,0x34,0xF8,0xE8,0x99,0x01,0x62,0x8F,0x41,0x1F,0x00,0x1E,0x22,0x40,0xC1,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
  //expected result
  u8 sha256res1[32]={0xd5,0x3c,0x1d,0xf1,0xff,0x81,0x96,0x36,0x06,0x05,0xb9,0xf1,0x7e,0xf1,0xee,0xf0,0x1b,0xbc,0xea,0x54,0x21,0xc5,0x5f,0xd9,0x56,0x1c,0x7b,0xe3,0xa4,0xa6,0xc8,0xc0};
  u8 digest[UCL_SIA256_HASHSIZE];
  u8 sha256data2[]={0x61,0x62,0x63};
#ifdef VERBOSE
  int i;
  PRINTF("SIA-256 TEST\n");
  PRINTF("sizeof(data)=%d\n",sizeof(sha256data1));
#endif
  ucl_sia256(digest,sha256data1,sizeof(sha256data1));
#ifdef VERBOSE
  for(i=0;i<UCL_SIA256_HASHSIZE;i++)
    PRINTF("%02x",digest[i]);
  PRINTF("\n");
#endif
  if(memcmp(sha256res1,digest,UCL_SIA256_HASHSIZE)!=0)
    {
#ifdef VERBOSE
      PRINTF("ERROR SIA-256 EX1\n");
#endif
      return(UCL_ERROR);
    }
  ucl_sia256(digest,sha256data2,3);
#ifdef VERBOSE
  for(i=0;i<UCL_SIA256_HASHSIZE;i++)
    PRINTF("%02x",digest[i]);
  PRINTF("\n");
#endif
  return(UCL_OK);
}
#endif//SIA256

#ifdef HASH_SHA256

int sample_hmac256(void)
{
  //NIST HMAC SHA 256
  u8 key_nist_30[]={0x97,0x79,0xd9,0x12,0x06,0x42,0x79,0x7f,0x17,0x47,0x02,0x5d,0x5b,0x22,0xb7,0xac,0x60,0x7c,0xab,0x08,0xe1,0x75,0x8f,0x2f,0x3a,0x46,0xc8,0xbe,0x1e,0x25,0xc5,0x3b,0x8c,0x6a,0x8f,0x58,0xff,0xef,0xa1,0x76};
  u8 msg_nist_30[]={0xb1,0x68,0x9c,0x25,0x91,0xea,0xf3,0xc9,0xe6,0x60,0x70,0xf8,0xa7,0x79,0x54,0xff,0xb8,0x17,0x49,0xf1,0xb0,0x03,0x46,0xf9,0xdf,0xe0,0xb2,0xee,0x90,0x5d,0xcc,0x28,0x8b,0xaf,0x4a,0x92,0xde,0x3f,0x40,0x01,0xdd,0x9f,0x44,0xc4,0x68,0xc3,0xd0,0x7d,0x6c,0x6e,0xe8,0x2f,0xac,0xea,0xfc,0x97,0xc2,0xfc,0x0f,0xc0,0x60,0x17,0x19,0xd2,0xdc,0xd0,0xaa,0x2a,0xec,0x92,0xd1,0xb0,0xae,0x93,0x3c,0x65,0xeb,0x06,0xa0,0x3c,0x9c,0x93,0x5c,0x2b,0xad,0x04,0x59,0x81,0x02,0x41,0x34,0x7a,0xb8,0x7e,0x9f,0x11,0xad,0xb3,0x04,0x15,0x42,0x4c,0x6c,0x7f,0x5f,0x22,0xa0,0x03,0xb8,0xab,0x8d,0xe5,0x4f,0x6d,0xed,0x0e,0x3a,0xb9,0x24,0x5f,0xa7,0x95,0x68,0x45,0x1d,0xfa,0x25,0x8e};
  u8 resu_nist_30[]={0x76,0x9f,0x00,0xd3,0xe6,0xa6,0xcc,0x1f,0xb4,0x26,0xa1,0x4a,0x4f,0x76,0xc6,0x46,0x2e,0x61,0x49,0x72,0x6e,0x0d,0xee,0x0e,0xc0,0xcf,0x97,0xa1,0x66,0x05,0xac,0x8b};
  u8 sharesult[32];
  int err;
  err=ucl_hmac_sha256 (sharesult, UCL_SHA256_HASHSIZE,msg_nist_30 , sizeof(msg_nist_30), key_nist_30, sizeof(key_nist_30));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA256\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,resu_nist_30,UCL_SHA256_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA256 KAT#1\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA256 KAT#1 OK\n");
  err=ucl_hmac_sha256 (sharesult, UCL_SHA256_HASHSIZE,msg_rfc4231_1 , sizeof(msg_rfc4231_1), key_rfc4231_1, sizeof(key_rfc4231_1));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA256\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac256_rfc4231_1,UCL_SHA256_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA256 RFC #1\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA256 RFC #1 OK\n");
  err=ucl_hmac_sha256 (sharesult, UCL_SHA256_HASHSIZE,msg_rfc4231_2 , sizeof(msg_rfc4231_2), key_rfc4231_2, sizeof(key_rfc4231_2));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA256\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac256_rfc4231_2,UCL_SHA256_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA256 RFC #2\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA256 RFC #2 OK\n");
  err=ucl_hmac_sha256 (sharesult, UCL_SHA256_HASHSIZE,msg_rfc4231_3 , sizeof(msg_rfc4231_3), key_rfc4231_3, sizeof(key_rfc4231_3));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA256\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac256_rfc4231_3,UCL_SHA256_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA256 RFC #3\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA256 RFC #3 OK\n");
  err=ucl_hmac_sha256 (sharesult, UCL_SHA256_HASHSIZE,msg_rfc4231_4 , sizeof(msg_rfc4231_4), key_rfc4231_4, sizeof(key_rfc4231_4));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA256\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac256_rfc4231_4,UCL_SHA256_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA256 RFC #4\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA256 RFC #4 OK\n");
  err=ucl_hmac_sha256 (sharesult, UCL_SHA256_HASHSIZE,msg_rfc4231_6 , sizeof(msg_rfc4231_6), key_rfc4231_6, sizeof(key_rfc4231_6));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA256\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac256_rfc4231_6,UCL_SHA256_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA256 RFC #6\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA256 RFC #6 OK\n");
  err=ucl_hmac_sha256 (sharesult, UCL_SHA256_HASHSIZE, (u8 *)msg_rfc4231_7 , sizeof(msg_rfc4231_7), (u8 *)key_rfc4231_7, sizeof(key_rfc4231_7));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA256\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac256_rfc4231_7,UCL_SHA256_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA256 RFC #7\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA256 RFC #7 OK\n");
  PRINTF(" OK\n");
  return(UCL_OK);
}

int test_sha256(void)
{
  /*
SHA-256 Test Data
#1) 1 byte 0xbd
68325720 aabd7c82 f30f554b 313d0570 c95accbb 7dc4b5aa e11204c0 8ffe732b
#2) 4 bytes 0xc98c8e55
7abc22c0 ae5af26c e93dbb94 433a0e0b 2e119d01 4f8e7f65 bd56c61c cccd9504
#3) 55 bytes of zeros
02779466 cdec1638 11d07881 5c633f21 90141308 1449002f 24aa3e80 f0b88ef7
#4) 56 bytes of zeros
d4817aa5 497628e7 c77e6b60 6107042b bba31308 88c5f47a 375e6179 be789fbb
#5) 57 bytes of zeros
65a16cb7 861335d5 ace3c607 18b5052e 44660726 da4cd13b b745381b 235a1785
#6) 64 bytes of zeros
f5a5fd42 d16a2030 2798ef6e d309979b 43003d23 20d9f0e8 ea9831a9 2759fb4b
#7) 1000 bytes of zeros
541b3e9d aa09b20b f85fa273 e5cbd3e8 0185aa4e c298e765 db87742b 70138a53
#8) 1000 bytes of 0x41 'A'
c2e68682 3489ced2 017f6059 b8b23931 8b6364f6 dcd835d0 a519105a 1eadd6e4
#9) 1005 bytes of 0x55 'U'
f4d62dde c0f3dd90 ea1380fa 16a5ff8d c4c54b21 740650f2 4afc4120 903552b0
#10) 1000000 bytes of zeros
d29751f2 649b32ff 572b5e0a 9f541ea6 60a50f94 ff0beedf b0b692b9 24cc8025
#11) 0x20000000 (536870912) bytes of 0x5a 'Z'
15a1868c 12cc5395 1e182344 277447cd 0979536b adcc512a d24c67e9 b2d4f3dd
#12) 0x41000000 (1090519040) bytes of zeros
461c19a9 3bd4344f 9215f5ec 64357090 342bc66b 15a14831 7d276e31 cbc20b53
#13) 0x6000003e (1610612798) bytes of 0x42 'B'
c23ce8a7 895f4b21 ec0daf37 920ac0a2 62a22004 5a03eb2d fed48ef9 b05aabea
  */
  // FIPS 180-2
  // "abc" l=24
  u8 sha256data1[]={0x61,0x62,0x63};
  u8 sha256res1[32]={0xba,0x78,0x16,0xbf,0x8f,0x01,0xcf,0xea,0x41,0x41,0x40,0xde,0x5d,0xae,0x22,0x23,0xb0,0x03,0x61,0xa3,0x96,0x17,0x7a,0x9c,0xb4,0x10,0xff,0x61,0xf2,0x00,0x15,0xad};
  // "abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq" l=448b
  u8 sha256data2[]={0x61,0x62,0x63,0x64,0x62,0x63,0x64,0x65,0x63,0x64,0x65,0x66,0x64,0x65,0x66,0x67,0x65,0x66,0x67,0x68,0x66,0x67,0x68,0x69,0x67,0x68,0x69,0x6A,0x68,0x69,0x6A,0x6B,0x69,0x6A,0x6B,0x6C,0x6A,0x6B,0x6C,0x6D,0x6B,0x6C,0x6D,0x6E,0x6C,0x6D,0x6E,0x6F,0x6D,0x6E,0x6F,0x70,0x6E,0x6F,0x70,0x71};
  u8 sha256res2[32]={0x24,0x8d,0x6a,0x61,0xd2,0x06,0x38,0xb8,0xe5,0xc0,0x26,0x93,0x0c,0x3e,0x60,0x39,0xa3,0x3c,0xe4,0x59,0x64,0xff,0x21,0x67,0xf6,0xec,0xed,0xd4,0x19,0xdb,0x06,0xc1};

  //data=1 million "a" 1 million 61
  u8 sha256res3[]={0xcd,0xc7,0x6e,0x5c,0x99,0x14,0xfb,0x92,0x81,0xa1,0xc7,0xe2,0x84,0xd7,0x3e,0x67,0xf1,0x80,0x9a,0x48,0xa4,0x97,0x20,0x0e,0x04,0x6d,0x39,0xcc,0xc7,0x11,0x2c,0xd0};
  unsigned int i;
  u8 million[1000];
  ucl_sha256_ctx_t ctxt;
  int err;
  u8 digest[UCL_SHA256_HASHSIZE];
  err=ucl_sha256(digest,sha256data1,sizeof(sha256data1));
  if(err!=UCL_OK)
    return(UCL_ERROR);
  if(memcmp(digest,sha256res1,UCL_SHA256_HASHSIZE)!=0)
    return(UCL_ERROR);
  err=ucl_sha256(digest,sha256data2,sizeof(sha256data2));
  if(err!=UCL_OK)
    return(UCL_ERROR);
  if(memcmp(digest,sha256res2,UCL_SHA256_HASHSIZE)!=0)
    return(UCL_ERROR);
  for(i=0;i<sizeof(million);i++)
    million[i]='a';

  ucl_sha256_init(&ctxt);
  for(i=0;i<1000000/sizeof(million);i++)
    ucl_sha256_core(&ctxt,million,sizeof(million));
  ucl_sha256_finish(digest,&ctxt);
  if(memcmp(digest,sha256res3,UCL_SHA256_HASHSIZE)!=0)
    return(UCL_ERROR);
  ucl_sha256(digest,million,128);
  return(UCL_OK);
}
#endif//SHA256

#ifdef HASH_SHA224
int test_sha224(void)
{
  /*
SHA-224 Test Data
#1) 1 byte 0xff
e33f9d75 e6ae1369 dbabf81b 96b4591a e46bba30 b591a6b6 c62542b5
#2) 4 bytes 0xe5e09924
fd19e746 90d29146 7ce59f07 7df31163 8f1c3a46 e510d0e4 9a67062d
#3) 56 bytes of zeros
5c3e25b6 9d0ea26f 260cfae8 7e23759e 1eca9d1e cc9fbf3c 62266804
#4) 1000 bytes of 0x51 'Q'
3706197f 66890a41 779dc879 1670522e 136fafa2 48746857 15bd0a8a
#5) 1000 bytes of 0x41 'A'
a8d0c66b 5c6fdfd8 36eb3c6d 04d32dfe 66c3b1f1 68b488bf 4c9c66ce
#6) 1005 bytes of 0x99
cb00ecd0 3788bf6c 0908401e 0eb053ac 61f35e7e 20a2cfd7 bd96d640
#7) 1000000 bytes of zeros
3a5d74b6 8f14f3a4 b2be9289 b8d37067 2d0b3d2f 53bc303c 59032df3
#8) 0x20000000 (536870912) bytes of 0x41 'A'
c4250083 cf8230bf 21065b30 14baaaf9 f76fecef c21f91cf 237dedc9
#9) 0x41000000 (1090519040) bytes of zeros
014674ab c5cb9801 99935695 af22fab6 83748f42 61d4c649 2b77c543
#10) 0x6000003f (1610612799) bytes of 0x84
a654b50b 767a8323 c5b519f4 67d86698 37142881 dc7ad368 a7d5ef8f
  */
  int i;
  ucl_sha224_ctx_t ctx;
  u8 e[UCL_SHA224_HASHSIZE];
  u8 mabc[3]={'a','b','c'};
  u8 mdoubleblock[]={"abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq"};
  u8 tab[2000];
  PRINTF("TEST SHA224\n");
  ucl_sha224(e,mabc,3);
   PRINTF("sha224(abc):");
  display("e:",e,UCL_SHA224_HASHSIZE);
  ucl_sha224(e,mdoubleblock,56);
  PRINTF("sha224(double-block):");
  display("e:",e,UCL_SHA224_HASHSIZE);
  tab[0]=0xff;
  ucl_sha224(e,tab,1);
  PRINTF("sha224(0xff):");
  //#1) 1 byte 0xff
  if(UCL_OK!=check(e,"e33f9d75e6ae1369dbabf81b96b4591ae46bba30b591a6b6c62542b5",28))
    return(UCL_ERROR);

  tab[0]=0xe5;
  tab[1]=0xe0;
  tab[2]=0x99;
  tab[3]=0x24;
  ucl_sha224(e,tab,4);
  PRINTF("sha224(4bytes):");
  //#2) 4 bytes 0xe5e09924
  if(UCL_OK!=check(e,"fd19e74690d291467ce59f077df311638f1c3a46e510d0e49a67062d",28))
    return(UCL_ERROR);

  for(i=0;i<56;i++)
    tab[i]=0;
  ucl_sha224(e,tab,56);
  PRINTF("sha224(56-0):");
  //#3) 56 bytes of zeros
  if(UCL_OK!=check(e,"5c3e25b69d0ea26f260cfae87e23759e1eca9d1ecc9fbf3c62266804",28))
    return(UCL_ERROR);

  for(i=0;i<1000;i++)
    tab[i]='Q';
  ucl_sha224(e,tab,1000);
  PRINTF("sha224(1000-Q):");
  //#4) 1000 bytes of 0x51 'Q'
  if(UCL_OK!=check(e,"3706197f66890a41779dc8791670522e136fafa24874685715bd0a8a",28))
    return(UCL_ERROR);

  for(i=0;i<1000;i++)
    tab[i]='A';
  ucl_sha224(e,tab,1000);
  PRINTF("sha224(1000-A):");
  //#5) 1000 bytes of 0x41 'A'
  if(UCL_OK!=check(e,"a8d0c66b5c6fdfd836eb3c6d04d32dfe66c3b1f168b488bf4c9c66ce",28))
    return(UCL_ERROR);

  for(i=0;i<1005;i++)
    tab[i]=0x99;
  ucl_sha224(e,tab,1005);
  PRINTF("sha224(1005-0x99):");
  //#6) 1005 bytes of 0x99
  if(UCL_OK!=check(e,"cb00ecd03788bf6c0908401e0eb053ac61f35e7e20a2cfd7bd96d640",28))
    return(UCL_ERROR);

  for(i=0;i<1000;i++)
    tab[i]=0;
  ucl_sha224_init(&ctx);
  for(i=0;i<1000;i++)
    ucl_sha224_core(&ctx,tab,1000);
  ucl_sha224_finish(e,&ctx);
  PRINTF("sha224(1mil-0):");
  if(UCL_OK!=check(e,"3a5d74b68f14f3a4b2be9289b8d370672d0b3d2f53bc303c59032df3",28))
    return(UCL_ERROR);

  for(i=0;i<512;i++)
    tab[i]='A';
  ucl_sha224_init(&ctx);
  for(i=0;i<1048576;i++)
    ucl_sha224_core(&ctx,tab,512);
  ucl_sha224_finish(e,&ctx);
  PRINTF("sha224(2^29-A):");
  //#8) 0x20000000 (536870912) bytes of 0x41 'A'
  if(UCL_OK!=check(e,"c4250083cf8230bf21065b3014baaaf9f76fecefc21f91cf237dedc9",28))
    return(UCL_ERROR);

  for(i=0;i<520;i++)
    tab[i]=0;
  ucl_sha224_init(&ctx);
  for(i=0;i<2097152;i++)
    ucl_sha224_core(&ctx,tab,520);
  ucl_sha224_finish(e,&ctx);
  PRINTF("sha224(2^24*5*13-0):");
  //#9) 0x41000000 (1090519040) bytes of zeros
  if(UCL_OK!=check(e,"014674abc5cb980199935695af22fab683748f4261d4c6492b77c543",28))
    return(UCL_ERROR);

  for(i=0;i<201;i++)
    tab[i]=0x84;
  ucl_sha224_init(&ctx);
  for(i=0;i<8012999;i++)
    ucl_sha224_core(&ctx,tab,201);
  ucl_sha224_finish(e,&ctx);
  PRINTF("sha224(3*41*67^2*2917-0x84):");
  //#10) 0x6000003f (1610612799) bytes of 0x84
  if(UCL_OK!=check(e,"a654b50b767a8323c5b519f467d8669837142881dc7ad368a7d5ef8f",28))
    return(UCL_ERROR);
  return(UCL_OK);
}
int sample_hmac224(void)
{
  //NIST SHA224 examples
  u8 test1[]={"Sample message for keylen<blocklen"};
  u8 shakey1[]={0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,0x0D,0x0E,0x0F,0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1A,0x1B};
  u8 sharesu1[]={0xE3,0xD2,0x49,0xA8,0xCF,0xB6,0x7E,0xF8,0xB7,0xA1,0x69,0xE9,0xA0,0xA5,0x99,0x71,0x4A,0x2C,0xEC,0xBA,0x65,0x99,0x9A,0x51,0xBE,0xB8,0xFB,0xBE};

  u8 test2[]={"Sample message for keylen=blocklen"};
  u8 shakey2[]={0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0A,0x0B,0x0C,0x0D,0x0E,0x0F,0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,0x1A,0x1B,0x1C,0x1D,0x1E,0x1F,0x20,0x21,0x22,0x23,0x24,0x25,0x26,0x27,0x28,0x29,0x2A,0x2B,0x2C,0x2D,0x2E,0x2F,0x30,0x31,0x32,0x33,0x34,0x35,0x36,0x37,0x38,0x39,0x3A,0x3B,0x3C,0x3D,0x3E,0x3F};
  u8 sharesu2[]={0xC7,0x40,0x5E,0x3A,0xE0,0x58,0xE8,0xCD,0x30,0xB0,0x8B,0x41,0x40,0x24,0x85,0x81,0xED,0x17,0x4C,0xB3,0x4E,0x12,0x24,0xBC,0xC1,0xEF,0xC8,0x1B};

  u8 sharesu3[28]={0x89,0x6f,0xb1,0x12,0x8a,0xbb,0xdf,0x19,0x68,0x32,0x10,0x7c,0xd4,0x9d,0xf3,0x3f,0x47,0xb4,0xb1,0x16,0x99,0x12,0xba,0x4f,0x53,0x68,0x4b,0x22};
  u8 test3[]={"Hi There"};
  u8 shakey3[20]={0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b};

  int err;
  u8 sharesult[UCL_SHA224_HASHSIZE];
  int i;
  PRINTF("HMAC-SHA224\n");
  err=ucl_hmac_sha224(sharesult, UCL_SHA224_HASHSIZE,test3 , 8, shakey3, 20);
  if(err!=UCL_OK)
    {
      PRINTF("ERROR UCL_HMAC_SHA224 test3 RETURN \n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,sharesu3,UCL_SHA224_HASHSIZE)!=0)
    {
      PRINTF("ERROR UCL_HMAC_SHA224 test3\n");
      for(i=0;i<UCL_SHA224_HASHSIZE;i++)
	PRINTF("%02x",sharesult[i]);
      PRINTF("\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("test3 OK\n");
  err=ucl_hmac_sha224(sharesult, UCL_SHA224_HASHSIZE,test2 , 34, shakey2, 64);
  if(err!=UCL_OK)
    {
      PRINTF("ERROR UCL_HMAC_SHA224 test2 RETURN \n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,sharesu2,UCL_SHA224_HASHSIZE)!=0)
    {
      PRINTF("ERROR UCL_HMAC_SHA224 test2\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("test2 OK\n");
  err=ucl_hmac_sha224 (sharesult, UCL_SHA224_HASHSIZE,test1 , 34, shakey1, 28);
  if(err!=UCL_OK)
    {
      PRINTF("ERROR UCL_HMAC_SHA224 test1 RETURN \n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,sharesu1,UCL_SHA224_HASHSIZE)!=0)
    {
      PRINTF("ERROR UCL_HMAC_SHA224 test1\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("test1 OK\n");

  err=ucl_hmac_sha224 (sharesult, UCL_SHA224_HASHSIZE,msg_rfc4231_1 , sizeof(msg_rfc4231_1), key_rfc4231_1, sizeof(key_rfc4231_1));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA224\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac224_rfc4231_1,UCL_SHA224_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA224 RFC #1\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA224 RFC #1 OK\n");
  err=ucl_hmac_sha224 (sharesult, UCL_SHA224_HASHSIZE,msg_rfc4231_2 , sizeof(msg_rfc4231_2), key_rfc4231_2, sizeof(key_rfc4231_2));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA224\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac224_rfc4231_2,UCL_SHA224_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA224 RFC #2\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA224 RFC #2 OK\n");
  err=ucl_hmac_sha224 (sharesult, UCL_SHA224_HASHSIZE,msg_rfc4231_3 , sizeof(msg_rfc4231_3), key_rfc4231_3, sizeof(key_rfc4231_3));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA224\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac224_rfc4231_3,UCL_SHA224_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA224 RFC #3\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA224 RFC #3 OK\n");
  err=ucl_hmac_sha224 (sharesult, UCL_SHA224_HASHSIZE,msg_rfc4231_4 , sizeof(msg_rfc4231_4), key_rfc4231_4, sizeof(key_rfc4231_4));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA224\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac224_rfc4231_4,UCL_SHA224_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA224 RFC #4\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA224 RFC #4 OK\n");
  err=ucl_hmac_sha224 (sharesult, UCL_SHA224_HASHSIZE,msg_rfc4231_6 , sizeof(msg_rfc4231_6), key_rfc4231_6, sizeof(key_rfc4231_6));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA224\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac224_rfc4231_6,UCL_SHA224_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA224 RFC #6\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA224 RFC #6 OK\n");
  err=ucl_hmac_sha224 (sharesult, UCL_SHA224_HASHSIZE, (u8 *)msg_rfc4231_7 , sizeof(msg_rfc4231_7), (u8 *)key_rfc4231_7, sizeof(key_rfc4231_7));
  if(UCL_OK!=err)
    {
      PRINTF("ERROR HMAC SHA224\n");
      return(UCL_ERROR);
    }
  if(memcmp(sharesult,mac224_rfc4231_7,UCL_SHA224_HASHSIZE)!=0)
    {
      PRINTF("ERROR HMAC-SHA224 RFC #7\n");
      return(UCL_ERROR);
    }
  else
    PRINTF("HMAC SHA224 RFC #7 OK\n");
  PRINTF(" OK\n");
  return(UCL_OK);
}
#endif//SHA224


int hash_selftests_testing(void)
{
  int err;
  PRINTF("TEST selftests SHA & HMAC-SHA\n");
#ifdef HASH_SM3
  err=ucl_hash_sm3_stest();
  if(UCL_OK!=err)
    {
    PRINTF("ERROR self-test sm3\n");
      return(UCL_ERROR);
    }
#endif
#ifdef HASH_SHA1
  err=ucl_hash_sha1_stest();
  if(UCL_OK!=err)
    {
    PRINTF("ERROR self-test sha1\n");
      return(UCL_ERROR);
    }
#endif
#ifdef HASH_SHA224
  err=ucl_hash_sha224_stest();
  if(UCL_OK!=err)
    {
    PRINTF("ERROR self-test sha224\n");
      return(UCL_ERROR);
    }
#endif
#ifdef HASH_SHA256
  err=ucl_hash_sha256_stest();
  if(UCL_OK!=err)
    {
    PRINTF("ERROR self-test sha256\n");
      return(UCL_ERROR);
    }
#endif
#ifdef HASH_SHA384
  err=ucl_hash_sha384_stest();
  if(UCL_OK!=err)
    {
    PRINTF("ERROR self-test sha384\n");
      return(UCL_ERROR);
    }
#endif
#ifdef HASH_SHA512
  err=ucl_hash_sha512_stest();
  if(UCL_OK!=err)
    {
    PRINTF("ERROR self-test sha512\n");
      return(UCL_ERROR);
    }
#endif
#ifdef HASH_SHA1
  err=ucl_hmac_sha1_stest();
  if(UCL_OK!=err)
    {
    PRINTF("ERROR self-test hmac sha1\n");
      return(UCL_ERROR);
    }
#endif
#ifdef HASH_SHA256
  err=ucl_hmac_sha256_stest();
  if(UCL_OK!=err)
    {
    PRINTF("ERROR self-test hmac sha256\n");
      return(UCL_ERROR);
    }
#endif
#ifdef HASH_SHA224
  err=ucl_hmac_sha224_stest();
  if(UCL_OK!=err)
    {
    PRINTF("ERROR self-test hmac sha224\n");
      return(UCL_ERROR);
    }
#endif
#ifdef HASH_SHA384
  err=ucl_hmac_sha384_stest();
  if(UCL_OK!=err)
    {
    PRINTF("ERROR self-test hmac sha384\n");
      return(UCL_ERROR);
    }
#endif
#ifdef HASH_SHA512
  err=ucl_hmac_sha512_stest();
  if(UCL_OK!=err)
    {
    PRINTF("ERROR self-test hmac sha512\n");
      return(UCL_ERROR);
    }
#endif

  PRINTF("END\n");
  return(UCL_OK);
}
